(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window&&(window.FunctionFoundry=require("./lib/functionfoundry"));
},{"./lib/functionfoundry":2}],2:[function(require,module,exports){
"use strict";function ISNUMBER(r){return"number"==typeof r&&!isNaN(r)&&isFinite(r)}function ABS(r){return ISNUMBER(r)?Math.abs(r):error$2.value}function ACOS(r){return ISNUMBER(r)?Math.acos(r):error$2.value}function ADD(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return ISNUMBER(n)&&ISNUMBER(o)?n+o:error$2.value}function AND(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return e!==!0&&e!==!1&&1!==e&&0!==e?error$2.value:r===error$2.value?error$2.value:r===!1?!1:e===!0||1===e})}function FLATTEN(r){return r.reduce(function(r,e){return r.concat(e)},[])}function SUM(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return FLATTEN(FLATTEN(e)).reduce(function(r,e){return"number"!=typeof e?error$2.value:r+e})}function ISERR(r){return r!==error$2.na&&"Error"===r.constructor.name||"number"==typeof r&&(Number.isNaN(r)||!Number.isFinite(r))}function ISERROR(r){return ISERR(r)||r===error$2.na}function AVERAGE(){var r=SUM.apply(void 0,arguments);return ISERROR(r)?r:r/arguments.length}function BIN2DEC(r){var e;if("string"==typeof r)e=r;else{if("undefined"==typeof r)return error$2.NA;e=r.toString()}return e.length>10?error$2.NUM:10===e.length&&"1"===e[0]?parseInt(e.substring(1),2)-512:parseInt(e,2)}function CELLINDEX(r,e){return Math.floor(r*MaxCols+e)}function UNIQUE(r){return r.reduce(function(r,e){return r.indexOf(e)<0&&r.push(e),r},[])}function CHANGED(r,e){var t=Object.keys(r),n=Object.keys(e);return UNIQUE(t.filter(function(t){return r[t]!==e[t]}).concat(n.filter(function(t){return r[t]!==e[t]})))}function CHOOSE(r){return r&&arguments.length-1!==0?1>r||r>254?error$2.value:arguments.length-1<r?error$2.value:arguments.length<=r-1+1?void 0:arguments[r-1+1]:error$2.na}function ISBLANK(r){return"undefined"==typeof r||null===r}function SELECT(r,e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&r?("string"==typeof r&&(r=r.split(/ *, */)),Array.isArray(e)?e.map(function(e){return r.reduce(function(r,t){return r[t]=e[t],r},{})}):r.reduce(function(r,t){return r[t]=e[t],r},{})):void 0}function CLEAN(r){var e=Object.keys(r).filter(function(e){return!ISBLANK(r[e])});return SELECT(e,r)}function CODE(){var r=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];return 1>e?error$2.na:r.length<e?error$2.value:r.charCodeAt(e-1)}function ISTEXT(r){return"string"==typeof r}function ISREF(r){return r?r.isRef===!0:!1}function COLUMNNUMBER(r){if(!ISTEXT(r))return error$2.value;var e,t=0;if(r.length>0){t=r.charCodeAt(0)-"A".charCodeAt(0);for(var n=1;n<r.length;n++)t+=1,t*=26,t+=r.charCodeAt(n)-"A".charCodeAt(0),e=!0;return t}return error$2.value}function COLUMN(r){return ISREF(r)?COLUMNNUMBER(r.column)+1:error$2.value}function COLUMNLETTER(r){if(!ISNUMBER(r))return error$2.value;var e,t="",n=!1,o=Math.abs(r);do e=o%26,n&&e--,t=String.fromCharCode(e+"A".charCodeAt(0))+t,o=Math.floor((o-e)/26),n=!0;while(o>0);return t}function CONCATENATE(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return""+r+e})}function COND(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=!1;return e.reduce(function(r,t,o){if(n===!0)return r;if(o===e.length-1){if(o%2===1)return;return t}return o%2===0&&t===!0?(n=!0,e[o+1]):r},void 0)}function ISARRAY(r){return"[object Array]"===Object.prototype.toString.call(r)}function EQ(r,e){return"string"==typeof r&&"string"==typeof e?r.toLowerCase()===e.toLowerCase():r===e}function IN(r,e){return ISBLANK(r)&&ISBLANK(e)?error$2.na:ISARRAY(e)?e.some(function(e){return EQ(e,r)}):error$2.na}function COS(r){return ISNUMBER(r)?Math.cos(r):error$2.value}function ISDATE(r){return r&&"[object Date]"==Object.prototype.toString.call(r)}function SERIAL(r){if(!ISDATE(r))return error$2.na;var e=Math.ceil((r-d1900)/MilliSecondsInDay);return e+(e>59?2:1)}function DATE(r,e,t){return SERIAL(new Date(r,e-1,t))}function PARSEDATE(r){function e(r){var e,t,n,o,a;return e=r+68569,t=Math.floor(4*e/146097),e-=Math.floor((146097*t+3)/4),n=Math.floor(4e3*(e+1)/1461001),e=e-Math.floor(1461*n/4)+31,o=Math.floor(80*e/2447),a=e-Math.floor(2447*o/80),e=Math.floor(o/11),o=o+2-12*e,n=100*(t-49)+n+e,new Date(n,o-1,a)}if(r instanceof Error)return r;if("number"==typeof r)return e(Math.floor(r+JulianOffset));if("string"==typeof r){var t=Date.parse(r);return isNaN(t)?error$2.value:new Date(t)}return error$2.value}function DATEVALUE(r){return SERIAL(PARSEDATE(r))}function DATEDIF(r,e,t){var n=1e3,o=60*n,a=60*o,u=24*a,s=7*u;r=new Date(r),e=new Date(e);var i=e-r;if(isNaN(i))return NaN;switch(t){case"Y":return e.getFullYear()-r.getFullYear();case"M":return 12*e.getFullYear()+e.getMonth()-(12*r.getFullYear()+r.getMonth());case"W":return Math.floor(i/s);case"D":return Math.floor(i/u);case"MD":return e.getDate()-r.getDate();case"YM":return e.getMonth()-r.getMonth();case"YD":return new Error("NOT IMPLEMENTED");default:return}}function PARSEBOOL(r){if(r instanceof Error)return r;if("boolean"==typeof r)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var e=r.toUpperCase();if("TRUE"===e||"FALSE"===e)return"TRUE"===e}return error$2.value}function DAYS360(r,e,t){if(t=PARSEBOOL(t),r=PARSEDATE(r),e=PARSEDATE(e),r instanceof Error)return r;if(e instanceof Error)return e;if(t instanceof Error)return t;var n,o,a=r.getMonth(),u=e.getMonth();if(t)n=31===r.getDate()?30:r.getDate(),o=31===e.getDate()?30:e.getDate();else{var s=new Date(r.getFullYear(),a+1,0).getDate(),i=new Date(e.getFullYear(),u+1,0).getDate();n=r.getDate()===s?30:r.getDate(),e.getDate()===i?30>n?(u++,o=1):o=30:o=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(u-a)+(o-n)}function REPT(r,e){for(var t="",n=0;e>n;n++)t+=r;return t}function DEC2BIN(r,e){if(r instanceof Error)return t;var t=parseInt(r);if(Number.isNaN(t))return error$2.value;if(!/^-?[0-9]{1,3}$/.test(t)||-512>t||t>511)return error$2.num;if(0>t)return"1"+REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return"undefined"==typeof e?n:isNaN(e)?error$2.value:0>e?error$2.num:(e=Math.floor(e),e>=n.length?REPT("0",e-n.length)+n:error$2.num)}function DIFF(r,e){var t=Object.keys(r),n=Object.keys(e),o=n.filter(function(r){return t.indexOf(r)>-1}),a=n.filter(function(r){return-1===t.indexOf(r)}),u=t.filter(function(r){return-1===n.indexOf(r)}),s=o.filter(function(t){return r[t]!==e[t]});return{left:r,right:e,unique_left:a,unique_right:u,diff:s.reduce(function(t,n){var o={};return o[n]={left:r[n],right:e[n]},Object.assign({},t,o)},{})}}function DIVIDE(r,e){return r/e}function FILTER(r){function e(){return function(r,e){return n.reduce(function(r,t){return r===!1?!1:t[e]},!0)}}for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;t>o;o++)n[o-1]=arguments[o];return r.filter(e())}function FIND(r){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t=e.indexOf(r,t-1),-1===t?error$2.value:t+1}function GT(r,e){return ISREF(r)&&ISREF(e)?error$2.na:ISARRAY(r)&&ISARRAY(e)?error$2.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return r>e}):ISREF(e)||ISARRAY(e)?e.map(function(e){return e>r}):r>e}function GTE(r,e){return ISREF(r)&&ISREF(e)?error.na:ISARRAY(r)&&ISARRAY(e)?error.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return r>=e}):ISREF(e)||ISARRAY(e)?e.map(function(e){return e>=r}):r>=e}function GUID(){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=16*Math.random()|0,t="x"==r?e:3&e|8;return t.toString(16)});return r}function HLOOKUP(r,e,t,n){if("undefined"==typeof r||ISBLANK(r))return null;for(var t=t||0,o=e[0],a=0;a<o.length;a++)if(n&&o[a]===r||-1!==o[a].toLowerCase().indexOf(r.toLowerCase()))return t<e.length+1?e[t-1][a]:e[0][a];return error.na}function IF(r,e,t){return r||"string"==typeof r&&"true"===r.toLowerCase()?e:t}function IFBLANK(r,e){return ISBLANK(r)?e:r}function ISEMPTY(r){return ISBLANK(r)||ISARRAY(r)&&0===r.length||ISTEXT(r)&&""===r}function IFEMPTY(r,e){return ISEMPTY(r)?e:r}function IFERROR(r){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return ISERROR(r)?e:r}function IFNA(r,e){return r===error$2.na?e:r}function INDEX2ROW(r){return Math.floor(r/MaxCols)}function INDEX2COL(r){return r-INDEX2ROW(r)*MaxCols}function ISFUNCTION(r){return r&&"[object Function]"==Object.prototype.toString.call(r)}function REF(r,e){if(!ISNUMBER(r)&&!ISFUNCTION(r))return error$2.value;ISBLANK(e)&&(e=r);var t=function(){return ISFUNCTION(r)?r():r},n=function(){return ISFUNCTION(e)?e():e};return{get isRef(){return!0},get top(){return t()},get bottom(){return n()},get row(){return INDEX2ROW(t())+1},get rowIndex(){return INDEX2ROW(t())},get column(){return COLUMNLETTER(INDEX2COL(t()))},get columnIndex(){return INDEX2COL(t())},get bottomRow(){return INDEX2ROW(n())+1},get bottomRowIndex(){return INDEX2ROW(n())},get bottomColumn(){return COLUMNLETTER(INDEX2COL(n()))},get bottomColumnIndex(){return INDEX2COL(n())},hit:function(r){return 0>r?error$2.na:r>=t()&&r<=n()},get size(){return 1+(n()-t())},get cells(){return Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return e+t()})},get rows(){return UNIQUE(Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return INDEX2ROW(e+t())}))}}}function INDIRECT(r){return REF(r)}function ISEMAIL(r){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(r)}function ISEVEN(r){return!(1&Math.floor(Math.abs(r)))}function ISNA(r){return r===error$2.na}function ISODD(r){return 1&Math.floor(Math.abs(r))}function ISURL(r){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(r)}function LEN(r){return 0===arguments.length?error$2.error:"string"==typeof r?r.length:r.length?r.length:error$2.value}function LOOKUP(){var r,e,t,n;if(2===arguments.length){r=arguments[0].valueOf(),e=arguments[1];for(var o=0;o<e.length;o++)if("undefined"!=typeof e[o]&&r===e[o].valueOf())return e[o]}else if(3===arguments.length){r=arguments[0].valueOf(),t=arguments[1],n=arguments[2];for(var o=0;o<t.length;o++)if("undefined"!=typeof t[o]&&r===t[o].valueOf())return n[o]}return error.na}function LOWER(r){return ISTEXT(r)?str.toLowerCase():error$2.value}function LT(r,e){return ISREF(r)&&ISREF(e)?error.na:ISARRAY(r)&&ISARRAY(e)?error.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return e>r}):ISREF(e)||ISARRAY(e)?e.map(function(e){return r>e}):e>r}function LTE(r,e){return ISREF(r)&&ISREF(e)?error.na:ISARRAY(r)&&ISARRAY(e)?error.na:ISREF(r)||ISARRAY(r)?r.map(function(r){return e>=r}):ISREF(e)||ISARRAY(e)?e.map(function(e){return r>=e}):e>=r}function MIN(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return FLATTEN(e).reduce(function(r,e){return ISNUMBER(e)?Math.min(r,e):r},Number.POSITIVE_INFINITY)}function MAX(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return FLATTEN(e).reduce(function(r,e){return ISNUMBER(e)?Math.max(r,e):r},Number.NEGATIVE_INFINITY)}function MULTIPLY(r,e){return r*e}function N(r){return ISNUMBER(r)||ISERROR(r)?r:r instanceof Date?SERIAL(r):r===!0?1:0}function NUMBERVALUE(r,e,t){e=e||".",t=t||",";var n=1;return ISEMPTY(r)?error$2.value:("%"===r[r.length-1]&&(n=100,r=r.substr(0,r.length-1)),Number(r.replace(RegExp("["+t+"]","g"),"").replace(e,"."))/n)}function NE(r,e){return!EQ(r,e)}function NOT(r){return!r}function OCT2DEC(r){if(!/^[0-7]{1,10}$/.test(r))return error$2.num;var e=parseInt(r,8);return e>=536870912?e-1073741824:e}function OR(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return r===!0?!0:e===!0||1===e},!1)}function PI(){return τ/2}function PMT(r,e,t){var n=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4];if(!ISNUMBER(r)||!ISNUMBER(e))return error$2.value;if(0===r)return-((t+n)/e);var a=Math.pow(1+r,e);return 1===o?-((n*r/(a-1)+t*r/(1-1/a))/(1+r)):-(n*r/(a-1)+t*r/(1-1/a))}function POWER(r,e){return Math.pow(r,e)}function REPLACE(r,e,t,n){return ISERROR(e)||ISERROR(t)||"string"!=typeof r||"string"!=typeof n?error$2.value:r.substr(0,e-1)+n+r.substr(e-1+t)}function RIGHT(r,e){return ISBLANK(r)?"":N(+e)?r.substring(r.length-e):r}function ROUND(r,e){return+r.toFixed(e)}function ROUNDUP(r,e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9],n=t[e];return r>0?Math.ceil(r*n)/n:Math.floor(r*n)/n}function SEARCH(r,e,t){if(!e)return null;t="undefined"==typeof t?1:t;var n=r.replace(/([^~])\?/g,"$1.").replace(/([^~])\*/g,"$1.*").replace(/([~])\?/g,"\\?").replace(/([~])\*/g,"\\*");return t=new RegExp(n,"i").exec(e),t?t.index+1:error$2.value}function SIN(r){return ISNUMBER(r)?Math.sin(r):error$2.value}function SORT(r){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];var o=function(){return function(r,e){for(var n=0,o=0;o<t.length;o+2){var a="string"==typeof t[o]?t[o]:t[o]-1,u=t[o+1];return r[a]<e[a]?u?-1:1:u?1:-1}return n}};return ISREF(r)||Array.isArray(r)?r.sort(o()):error$2.na}function SPLIT(r,e){return r.split(e)}function SUBSTITUTE(r,e,t,n){if(!(r&&e&&t))return r;if(void 0===n)return r.replace(new RegExp(e,"g"),t);for(var o=0,a=0;r.indexOf(e,o)>0;)if(o=r.indexOf(e,o+1),a++,a===n)return r.substring(0,o)+t+r.substring(o+e.length)}function SUBTRACT(r,e){return r-e}function SWITCH(){return COND.apply(void 0,arguments)}function TAN(r){return ISNUMBER(r)?Math.tan(r):error$2.value}function TAU(){return τ}function TEXT(r,e,t){return FormatNumber.formatNumberWithFormat(r,e,t)}function TRIM(r){return"string"!=typeof r?error$2.value:r.trim()}function UPPER(r){return r.toUpperCase()}function VLOOKUP(r,e,t,n){if(ISERROR(r)||ISBLANK(r))return r;t=t||0,n=n||!1;for(var o=0;o<e.length;o++){var a=e[o];if(n&&a[0]===r||a[0]===r||"string"==typeof a[0]&&-1!=a[0].toLowerCase().indexOf(r.toLowerCase()))return t<a.length+1?a[t-1]:a[0]}return error$2.na}function XOR(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return 1&FLATTEN(e).reduce(function(r,e){return e?r+1:r},0)}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":typeof r},nil=new Error("#NULL!"),div0=new Error("#DIV/0!"),value=new Error("#VALUE?"),ref=new Error("#REF!"),name=new Error("#NAME?"),num=new Error("#NUM!"),na=new Error("#N/A"),error$1=new Error("#Error("),data=new Error("#GETTING_DATA"),missing=new Error("#MISSING"),unknown=new Error("#UNKNOWN"),error$2={nil:nil,div0:div0,value:value,ref:ref,name:name,num:num,na:na,error:error$1,data:data,missing:missing,unknown:unknown},d1900=new Date(1900,0,1),JulianOffset=2415019,SecondsInHour=3600,SecondsInDay=86400,MilliSecondsInDay=864e5,DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DayNames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],MonthNames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AM="AM",AM1="A",PM="PM",PM1="P",τ=6.28318530717958,MaxCols=16384,SeparatorChar=",",DecimalChar=".",DefaultCurrency="$",AllowedColors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},CONTAINS=IN,EXACT=function(r,e){return r===e},FormatNumber={};FormatNumber.format_definitions={},FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},FormatNumber.formatNumberWithFormat=function(r,e,t){var n,o,a,u,s,i,f,c,p,E,l,m,I,d,N,A,h,R,S,g,T,O,M,x,D,L,C,y,F,v,U,b,$,P,B,w,Y,j,X,_,G=FormatNumber,K="";if(r-=0,_=r,!isFinite(_))return"NaN";var W=0>_?1:0;W&&(_=-_);var H=0==_?1:0;if(t=t||DefaultCurrency,FormatNumber.parse_format_string(G.format_definitions,e),R=G.format_definitions[e],!R)throw"Format not parsed error.";if(S=R.sectioninfo.length-1,R.hascomparison)for(S=0,g=0,M=0;;M++){if(n=R.operators[M],o=R.operands[M],!n){g&&(e="General",G.parse_format_string(G.format_definitions,e),R=G.format_definitions[e],S=0);break}if(n!=G.commands.section){if(n==G.commands.comparison){if(L=o.indexOf(":"),T=o.substring(0,L),O=o.substring(L+1)-0,"<"==T&&O>r||"<="==T&&O>=r||"="==T&&r==O||"<>"==T&&r!=O||">="==T&&r>=O||">"==T&&r>O)break;g=1}}else{if(!g)break;g=0,S++}}else S>0&&(1==S?W?(W=0,S=1):S=0:2==S&&(W?(W=0,S=1):S=H?2:0));if(D=R.sectioninfo[S],D.commas>0)for(L=0;L<D.commas;L++)_/=1e3;if(D.percent>0)for(L=0;L<D.percent;L++)_*=100;for(C=1,L=0;L<D.fractiondigits;L++)C*=10;if(y=Math.floor(_*C+.5),y/=C,"number"!=typeof y)return"NaN";if(!isFinite(y))return"NaN";if(F=y+"",0==y&&(D.fractiondigits||D.integerdigits)&&(W=0),F.indexOf("e")>=0)return r+"";if(v=F.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!v)return"NaN";if(U=v[1],U&&"0"!=U||(U=""),b=v[2],b||(b=""),D.hasdate){if(0>r)return"??-???-?? ??:??:??";for(i=(r-Math.floor(r))*SecondsInDay,f=r*SecondsInDay,c=Math.floor(i/SecondsInHour),l=Math.floor(f/SecondsInHour),i-=c*SecondsInHour,p=Math.floor(i/60),m=Math.floor(f/60),E=i-60*p,C=1,L=0;L<D.fractiondigits;L++)C*=10;for(E=Math.floor(E*C+.5),E/=C,I=Math.floor(f*C+.5),I/=C,E>=60&&(E=0,p++,m++,p>=60&&(p=0,c++,l++,c>=24&&(c=0,r++))),b=E-Math.floor(E)+"",b=b.substring(2),N=PARSEDATE(r),N={year:N.getFullYear(),month:N.getMonth()+1,day:N.getDate()},A=0,h=D.sectionstart;(n=R.operators[h],o=R.operands[h],n)&&n!=G.commands.section;h++)n==G.commands.date?("am/pm"!=o.toLowerCase()&&"a/p"!=o.toLowerCase()||d||(c>=12?(c-=12,d="a/p"==o.toLowerCase()?PM1:PM):d="a/p"==o.toLowerCase()?AM1:AM,o.indexOf(d)<0&&(d=d.toLowerCase())),!A||"m"!=o&&"mm"!=o||(R.operands[h]+="in"),A="h"==o.charAt(0)?1:0):n!=G.commands.copy&&(A=0);for(A=0,--h;(n=R.operators[h],o=R.operands[h],n)&&n!=G.commands.section;h--)n==G.commands.date?(!A||"m"!=o&&"mm"!=o||(R.operands[h]+="in"),A="ss"==o?1:0):n!=G.commands.copy&&(A=0)}for($=0,P=0,B=0,w="",Y="",j=SeparatorChar,j.indexOf(" ")>=0&&(j=j.replace(/ /g," ")),X=DecimalChar,X.indexOf(" ")>=0&&(X=X.replace(/ /g," ")),x=D.sectionstart;n=R.operators[x];)if(o=R.operands[x++],n==G.commands.copy)K+=o;else if(n==G.commands.color)w=o;else if(n==G.commands.style)Y=o;else if(n==G.commands.integer_placeholder){if(W&&(K+="-",W=0),$++,1==$&&U.length>D.integerdigits)for(;P<U.length-D.integerdigits;P++)K+=U.charAt(P),D.thousandssep&&(a=U.length-P-1,a>2&&a%3==0&&(K+=j));U.length<D.integerdigits&&$<=D.integerdigits-U.length?"0"!=o&&"?"!=o||(K+="0"==o?"0":" ",D.thousandssep&&(a=D.integerdigits-$,a>2&&a%3==0&&(K+=j))):(K+=U.charAt(P),D.thousandssep&&(a=U.length-P-1,a>2&&a%3==0&&(K+=j)),P++)}else if(n==G.commands.fraction_placeholder)B>=b.length?"0"!=o&&"?"!=o||(K+="0"==o?"0":" "):K+=b.charAt(B),B++;else if(n==G.commands.decimal)W&&(K+="-",W=0),K+=X;else if(n==G.commands.currency)W&&(K+="-",W=0),K+=o;else if(n==G.commands.general){if(0!=_){var V=Math.floor(Math.LOG10E*Math.log(_));if(V=Math.pow(10,13-V),_=Math.floor(V*_+.5)/V,!isFinite(_))return"NaN"}if(W&&(K+="-"),F=_+"",F.indexOf("e")>=0){K+=F;continue}if(v=F.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),U=v[1],U&&"0"!=U||(U=""),b=v[2],b||(b=""),P=0,B=0,U.length)for(;P<U.length;P++)K+=U.charAt(P),D.thousandssep&&(a=U.length-P-1,a>2&&a%3==0&&(K+=j));else K+="0";if(b.length)for(K+=X;B<b.length;B++)K+=b.charAt(B)}else if(n==G.commands.date)s=o.toLowerCase(),"y"==s||"yy"==s?K+=(N.year+"").substring(2):"yyyy"==s?K+=N.year+"":"d"==s?K+=N.day+"":"dd"==s?(u=1e3+N.day,K+=(u+"").substr(2)):"ddd"==s?(u=Math.floor(r+6)%7,K+=DayNames3[u]):"dddd"==s?(u=Math.floor(r+6)%7,K+=DayNames[u]):"m"==s?K+=N.month+"":"mm"==s?(u=1e3+N.month,K+=(u+"").substr(2)):"mmm"==s?K+=MonthNames3[N.month-1]:"mmmm"==s?K+=MonthNames[N.month-1]:"mmmmm"==s?K+=MonthNames[N.month-1].charAt(0):"h"==s?K+=c+"":"h]"==s?K+=l+"":"mmin"==s?(u=1e3+p+"",K+=u.substr(2)):"mm]"==s?100>m?(u=1e3+m+"",K+=u.substr(2)):K+=m+"":"min"==s?K+=p+"":"m]"==s?K+=m+"":"hh"==s?(u=1e3+c+"",K+=u.substr(2)):"s"==s?(u=Math.floor(E),K+=u+""):"ss"==s?(u=1e3+Math.floor(E)+"",K+=u.substr(2)):"am/pm"==s||"a/p"==s?K+=d:"ss]"==s&&(100>I?(u=1e3+Math.floor(I)+"",K+=u.substr(2)):(u=Math.floor(I),K+=u+""));else{if(n==G.commands.section)break;if(n==G.commands.comparison)continue;K+="!! Parse error.!!"}return w&&(K='<span style="color:'+w+';">'+K+"</span>"),Y&&(K='<span style="'+Y+';">'+K+"</span>"),K},FormatNumber.parse_format_string=function(r,e){var t,n,o,a,u,s,i,f,c,p,E,l,m,I,d,N,A,h,R=FormatNumber,S=1;if(!r[e]){for(t={operators:[],operands:[],sectioninfo:[{}]},r[e]=t,n=0,o=t.sectioninfo[n],o.sectionstart=0,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,A=0;A<e.length;A++)if(h=e.charAt(A),f){if('"'==h){f=0,t.operators.push(R.commands.copy),t.operands.push(c);continue}c+=h}else if(p){if("]"==h){if(p=0,l=FormatNumber.parse_format_bracket(E),l.operator==R.commands.separator){o.thousandssep=1;continue}l.operator==R.commands.date&&(o.hasdate=1),l.operator==R.commands.comparison&&(t.hascomparison=1),t.operators.push(l.operator),t.operands.push(l.operand);continue}E+=h}else if(u)t.operators.push(R.commands.copy),t.operands.push(h),u=!1;else if(s)t.operators.push(R.commands.copy),t.operands.push(h+h+h+h+h),s=!1;else if(i)t.operators.push(R.commands.copy),t.operands.push(" "),i=!1;else{if(m){if("general".charAt(m)==h.toLowerCase()){m++,7==m&&(t.operators.push(R.commands.general),t.operands.push(h),m=0);continue}m=0}if(N){if(N.charAt(0)==h){N+=h;continue}t.operators.push(R.commands.date),t.operands.push(N),o.hasdate=1,N=""}I?(I+=h,d=I.toLowerCase(),d!="am/pm".substring(0,d.length)&&d!="a/p".substring(0,d.length)?ampstr="":"am/pm"!=d&&"a/p"!=d||(t.operators.push(R.commands.date),t.operands.push(I),I="")):"#"==h||"0"==h||"?"==h?S?(o.integerdigits++,o.commas&&(o.thousandssep=1,o.commas=0),a=1,t.operators.push(R.commands.integer_placeholder),t.operands.push(h)):(o.fractiondigits++,t.operators.push(R.commands.fraction_placeholder),t.operands.push(h)):"."==h?(a=0,t.operators.push(R.commands.decimal),t.operands.push(h),S=0):"$"===h?(a=0,t.operators.push(R.commands.currency),t.operands.push(h)):","==h?a?o.commas++:(t.operators.push(R.commands.copy),t.operands.push(h)):"%"==h?(a=0,o.percent++,t.operators.push(R.commands.copy),t.operands.push(h)):'"'==h?(a=0,f=1,c=""):"["==h?(a=0,p=1,E=""):"\\"==h?(u=1,a=0):"*"==h?(s=1,a=0):"_"==h?(i=1,a=0):";"==h?(n++,t.sectioninfo[n]={},o=t.sectioninfo[n],o.sectionstart=1+t.operators.length,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,S=1,a=0,t.operators.push(R.commands.section),t.operands.push(h)):"g"==h.toLowerCase()?(m=1,a=0):"a"==h.toLowerCase()?(I=h,a=0):"dmyhHs".indexOf(h)>=0?N=h:(a=0,t.operators.push(R.commands.copy),t.operands.push(h))}N&&(t.operators.push(R.commands.date),t.operands.push(N),o.hasdate=1)}},FormatNumber.parse_format_bracket=function(r){var e,t=FormatNumber,n={};return"$"==r.charAt(0)?(n.operator=t.commands.currency,e=r.match(/^\$(.+?)(\-.+?){0,1}$/),e?n.operand=e[1]||DefaultCurrency||"$":n.operand=r.substring(1)||DefaultCurrency||"$"):"?$"==r?(n.operator=t.commands.currency,n.operand="[?$]"):AllowedColors[r.toUpperCase()]?(n.operator=t.commands.color,n.operand=AllowedColors[r.toUpperCase()]):(e=r.match(/^style=([^']*)$/))?(n.operator=t.commands.style,n.operand=e[1]):","==r?(n.operator=t.commands.separator,n.operand=r):AllowedDates[r.toUpperCase()]?(n.operator=t.commands.date,n.operand=AllowedDates[r.toUpperCase()]):(e=r.match(/^[<>=]/))?(e=r.match(/^([<>=]+)(.+)$/),n.operator=t.commands.comparison,n.operand=e[1]+":"+e[2]):(n.operator=t.commands.copy,n.operand="["+r+"]"),n},exports.ABS=ABS,exports.ACOS=ACOS,exports.ADD=ADD,exports.AND=AND,exports.AVERAGE=AVERAGE,exports.BIN2DEC=BIN2DEC,exports.CELLINDEX=CELLINDEX,exports.CHANGED=CHANGED,exports.CHOOSE=CHOOSE,exports.CLEAN=CLEAN,exports.CODE=CODE,exports.COLUMN=COLUMN,exports.COLUMNLETTER=COLUMNLETTER,exports.COLUMNNUMBER=COLUMNNUMBER,exports.CONCATENATE=CONCATENATE,exports.COND=COND,exports.CONTAINS=CONTAINS,exports.COS=COS,exports.DATE=DATE,exports.DATEVALUE=DATEVALUE,exports.DATEDIF=DATEDIF,exports.DAYS360=DAYS360,exports.DEC2BIN=DEC2BIN,exports.DIFF=DIFF,exports.DIVIDE=DIVIDE,exports.EQ=EQ,exports.EXACT=EXACT,exports.FILTER=FILTER,exports.FIND=FIND,exports.FLATTEN=FLATTEN,exports.GT=GT,exports.GTE=GTE,exports.GUID=GUID,exports.HLOOKUP=HLOOKUP,exports.IF=IF,exports.IFBLANK=IFBLANK,exports.IFEMPTY=IFEMPTY,exports.IFERROR=IFERROR,exports.IFNA=IFNA,exports.IN=IN,exports.INDEX2COL=INDEX2COL,exports.INDEX2ROW=INDEX2ROW,exports.INDIRECT=INDIRECT,exports.ISARRAY=ISARRAY,exports.ISBLANK=ISBLANK,exports.ISDATE=ISDATE,exports.ISEMAIL=ISEMAIL,exports.ISEMPTY=ISEMPTY,exports.ISERROR=ISERROR,exports.ISEVEN=ISEVEN,exports.ISFUNCTION=ISFUNCTION,exports.ISNA=ISNA,exports.ISNUMBER=ISNUMBER,exports.ISODD=ISODD,exports.ISREF=ISREF,exports.ISTEXT=ISTEXT,exports.ISURL=ISURL,exports.LEN=LEN,exports.LOOKUP=LOOKUP,exports.LOWER=LOWER,exports.LT=LT,exports.LTE=LTE,exports.MIN=MIN,exports.MAX=MAX,exports.MULTIPLY=MULTIPLY,exports.N=N,exports.NUMBERVALUE=NUMBERVALUE,exports.NE=NE,exports.NOT=NOT,exports.OCT2DEC=OCT2DEC,exports.OR=OR,exports.PARSEBOOL=PARSEBOOL,exports.PARSEDATE=PARSEDATE,exports.PI=PI,exports.PMT=PMT,exports.POWER=POWER,exports.REF=REF,exports.REPLACE=REPLACE,exports.REPT=REPT,exports.RIGHT=RIGHT,exports.ROUND=ROUND,exports.ROUNDUP=ROUNDUP,exports.SEARCH=SEARCH,exports.SELECT=SELECT,exports.SERIAL=SERIAL,exports.SIN=SIN,exports.SORT=SORT,exports.SPLIT=SPLIT,exports.SUBSTITUTE=SUBSTITUTE,exports.SUBTRACT=SUBTRACT,exports.SUM=SUM,exports.SWITCH=SWITCH,exports.TAN=TAN,exports.TAU=TAU,exports.TEXT=TEXT,exports.TRIM=TRIM,exports.UNIQUE=UNIQUE,exports.UPPER=UPPER,exports.VLOOKUP=VLOOKUP,exports.XOR=XOR;

},{}]},{},[1]);
