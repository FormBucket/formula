(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window&&(window.FunctionFoundry=require("./lib/functionfoundry"));
},{"./lib/functionfoundry":2}],2:[function(require,module,exports){
"use strict";function isfunction(r){return r&&"[object Function]"==Object.prototype.toString.call(r)}function branch(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=!1;return e.reduce(function(r,t,o){var a=void 0;if(n===!0)return r;if(o===e.length-1){if(o%2===1)return;return isfunction(t)?t():t}return o%2===0&&(isfunction(t)&&t()===!0||t===!0)?(n=!0,a=e[o+1],isfunction(a)?a():a):r},void 0)}function FFError(r,e){this.name=e||"NotImplementedError",this.message=r||""}function choose(r){return r&&0!==(arguments.length<=1?0:arguments.length-1)?r<1||r>254?error$2.value:(arguments.length<=1?0:arguments.length-1)<r?error$2.value:arguments.length<=r-1+1?void 0:arguments[r-1+1]:error$2.na}function iserr(r){return r!==error$2.na&&"Error"===r.constructor.name||"number"==typeof r&&(Number.isNaN(r)||!Number.isFinite(r))}function iserror(r){return iserr(r)||r===error$2.na}function and(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return e.reduce(function(r,e){if(r===!1||iserror(r))return r;var t=isfunction(e)?e():e;return t!==!0&&t!==!1&&1!==t&&0!==t?error$2.value:t===!0||1===t})}function or(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return e.reduce(function(r,e){if(r===!0)return!0;var t=isfunction(e)?e():e;return t===!0||1===t},!1)}function not(r){return r!==!0&&r!==!1&&1!==r&&0!==r?error$2.value:!r}function eq(r,e){return"string"==typeof r&&"string"==typeof e?r.toLowerCase()===e.toLowerCase():r===e}function ne(r,e){return!eq(r,e)}function isarray(r){return"[object Array]"===Object.prototype.toString.call(r)}function isblank(r){return"undefined"==typeof r||null===r}function isref(r){return!!r&&r._isref===!0}function gt(r,e){return isref(r)&&isref(e)?error$2.na:isarray(r)&&isarray(e)?error$2.na:isref(r)||isarray(r)?r.map(function(r){return r>e}):isref(e)||isarray(e)?e.map(function(e){return e>r}):r>e}function gte(r,e){return isref(r)&&isref(e)?error.na:isarray(r)&&isarray(e)?error.na:isref(r)||isarray(r)?r.map(function(r){return r>=e}):isref(e)||isarray(e)?e.map(function(e){return e>=r}):r>=e}function lt(r,e){return isref(r)&&isref(e)?error.na:isarray(r)&&isarray(e)?error.na:isref(r)||isarray(r)?r.map(function(r){return r<e}):isref(e)||isarray(e)?e.map(function(e){return e<r}):r<e}function lte(r,e){return isref(r)&&isref(e)?error.na:isarray(r)&&isarray(e)?error.na:isref(r)||isarray(r)?r.map(function(r){return r<=e}):isref(e)||isarray(e)?e.map(function(e){return e<=r}):r<=e}function ifblank(r,e){return isblank(r)?e:r}function istext(r){return"string"==typeof r}function isempty(r){return isblank(r)||isarray(r)&&0===r.length||istext(r)&&""===r}function ifempty(r,e){return isempty(r)?e:r}function iferror(r){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return iserror(r)?e:r}function ifna(r,e){return r===error$2.na?e:r}function isboolean(r){return r===!0||r===!1}function isdate(r){return r&&"[object Date]"==Object.prototype.toString.call(r)}function isemail(r){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(r)}function iseven(r){return!(1&Math.floor(Math.abs(r)))}function parsedate(r){function e(r){var e,t,n,o,a;return e=r+68569,t=Math.floor(4*e/146097),e-=Math.floor((146097*t+3)/4),n=Math.floor(4e3*(e+1)/1461001),e=e-Math.floor(1461*n/4)+31,o=Math.floor(80*e/2447),a=e-Math.floor(2447*o/80),e=Math.floor(o/11),o=o+2-12*e,n=100*(t-49)+n+e,new Date(n,o-1,a)}if(r instanceof Error)return r;if("number"==typeof r)return e(Math.floor(r+JulianOffset));if("string"==typeof r){var t=Date.parse(r);return Number.isNaN(t)?error$2.value:new Date(t)}return error$2.value}function isleapyear(r){var e=parsedate(r),t=e.getFullYear();return t%4===0&&t%100!==0||t%400===0}function isna(r){return r===error$2.na}function isnumber(r){return"number"==typeof r&&!Number.isNaN(r)&&isFinite(r)}function isodd(r){return!!(1&Math.floor(Math.abs(r)))}function isoweeknum(r){if(r=parsedate(r),r instanceof Error)return r;r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r-e)/MilliSecondsInDay+1)/7)}function isurl(r){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(r)}function iswholenumber(r){return isnumber(r)&&r%1===0}function flatten(r){return r.reduce(function(r,e){return r.concat(e)},[])}function xor(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return!!(1&flatten(e).reduce(function(r,e){return e?r+1:r},0))}function add(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?n+o:error$2.value}function subtract(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?n-o:error$2.value}function multiply(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?n*o:error$2.value}function divide(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return 0===o?error$2.div0:isnumber(n)&&isnumber(o)?n/o:error$2.value}function abs(r){return isnumber(r)?Math.abs(r):error$2.value}function acos(r){return isnumber(r)?Math.acos(r):error$2.value}function cos(r){return isnumber(r)?Math.cos(r):error$2.value}function pi(){return τ/2}function power(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?Math.pow(n,o):error$2.value}function round(r,e){return+r.toFixed(e)}function roundup(r,e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9],n=t[e];return r>0?Math.ceil(r*n)/n:Math.floor(r*n)/n}function sin(r){return isnumber(r)?Math.sin(r):error$2.value}function tan(r){return isnumber(r)?Math.tan(r):error$2.value}function tau(){return τ}function trunc(r){return 0|r}function char(r){return String.fromCharCode(r)}function code(){var r=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];return e<1?error$2.na:r.length<e?error$2.value:r.charCodeAt(e-1)}function concatenate(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return e.reduce(function(r,e){return""+r+e})}function find(r){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t=e.indexOf(r,t-1),t===-1?error$2.value:t+1}function join(r){var e=arguments.length<=1||void 0===arguments[1]?", ":arguments[1];return r.some(function(r){return"string"!=typeof r&&"number"!=typeof r})?error$2.value:r.join(e)}function serial(r){if(!isdate(r))return error$2.na;var e=Math.ceil((r-d1900)/MilliSecondsInDay);return e+(e>59?2:1)}function n(r){return isnumber(r)||iserror(r)?r:r instanceof Date?serial(r):r===!0?1:0}function left(r,e){return isblank(r)?"":n(+e)?r.substring(0,e):r}function len(r){return 0===arguments.length?error$2.error:"string"==typeof r?r.length:r.length?r.length:error$2.value}function lower(r){return istext(r)?r.toLowerCase():error$2.value}function numbervalue(r,e,t){if(e=e||".",t=t||",",isempty(r))return error$2.value;if(isnumber(r))return r;var n=!1,o=r.length-1;return 1===r.length?r.charCodeAt(0)<48||r.charCodeAt(0)>57?error$2.value:+r:r.split("").reduce(function(r,a,i){return r===error$2.value?error$2.value:o===i?"%"===a?+r/100:+r.concat(a):a===e?n?error$2.value:(n=!0,r.concat(".")):a===t?r:a.charCodeAt(0)<48||a.charCodeAt(0)>57?error$2.value:r.concat(a)})}function parsebool(r){if(r instanceof Error)return r;if("boolean"==typeof r)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var e=r.toUpperCase();if("TRUE"===e||"FALSE"===e)return"TRUE"===e}return error$2.value}function parsequery(){var r=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return"string"!=typeof r?error$2.na:0===r.length?{}:("?"===r[0]?r.substr(1):r).split("&").reduce(function(r,e){var t=e.split("=");return r[t[0]]=t[1]?t[1]:"",r},{})}function proper(r){return void 0===r||0===r.length?error$2.value:(r===!0&&(r="TRUE"),r===!1&&(r="FALSE"),Number.isNaN(r)&&"number"==typeof r?error$2.value:("number"==typeof r&&(r=""+r),r.replace(/\w\S*/g,function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()})))}function replace(r,e,t,n){return iserror(e)||iserror(t)||"string"!=typeof r||"string"!=typeof n?error$2.value:r.substr(0,e-1)+n+r.substr(e-1+t)}function right(r,e){return isblank(r)?"":n(+e)?r.substring(r.length-e):r}function rept(r,e){for(var t="",n=0;n<e;n++)t+=r;return t}function search(r,e,t){if(!e)return null;t="undefined"==typeof t?1:t;var n=r.replace(/([^~])\?/g,"$1.").replace(/([^~])\*/g,"$1.*").replace(/([~])\?/g,"\\?").replace(/([~])\*/g,"\\*");return t=new RegExp(n,"i").exec(e),t?t.index+1:error$2.value}function substitute(r,e,t,n){if(!(r&&e&&t))return r;if(void 0===n)return r.replace(new RegExp(e,"g"),t);for(var o=0,a=0;r.indexOf(e,o)>0;)if(o=r.indexOf(e,o+1),a++,a===n)return r.substring(0,o)+t+r.substring(o+e.length)}function substituteAll(r,e){var t=arguments.length<=2||void 0===arguments[2]?"-":arguments[2],n=arguments[3];return e?(n=n||t,Object.keys(e).reduce(function(r,o){return substitute(r,""+t+o+n,e[o])},r)):r}function surroundKeys(r){var e=arguments.length<=1||void 0===arguments[1]?"-":arguments[1],t=arguments[2];return t=t||e,Object.keys(r).reduce(function(n,o){return n[""+e+o+t]=r[o],n},{})}function split(r,e){return r.split(e)}function text(r,e,t){return FormatNumber.formatNumberWithFormat(r,e,t)}function trim(r){return"string"!=typeof r?error$2.value:r.trim()}function upper(r){return r.toUpperCase()}function hlookup(r,e){var t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=arguments[3];if("undefined"==typeof r||isblank(r))return null;if(t>e.length)return error$2.ref;for(var o=(r+"").toLowerCase(),a=e[0],i=0;i<a.length;i++)if(n&&a[i]===r||a[i]==r||"string"==typeof a[i]&&a[i].toLowerCase().indexOf(o)!=-1)return e[t-1][i];return error$2.na}function index(r,e){var t,n=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return!isarray(r)||isblank(e)?error$2.value:r.length<e?error$2.ref:(t=r[e-1],isarray(t)?t.length<n?error$2.ref:t[n-1]:error$2.value)}function lookup(){var r,e,t,n;if(2===arguments.length){r=arguments[0].valueOf(),e=arguments[1];for(var o=0;o<e.length;o++)if("undefined"!=typeof e[o]&&r===e[o].valueOf())return e[o]}else if(3===arguments.length){r=arguments[0].valueOf(),t=arguments[1],n=arguments[2];for(var o=0;o<t.length;o++)if("undefined"!=typeof t[o]&&r===t[o].valueOf())return n[o]}return error.na}function match(r,e,t){var n,o,a,i;if(2===arguments.length&&(t=1),o=r,!isarray(e))return error$2.na;if(n=e,!o&&!n)return error$2.na;if(t!==-1&&0!==t&&1!==t)return error$2.na;for(var s=0;s<n.length;s++)if(1===t){if(n[s]===o)return s+1;n[s]<o&&(i?n[s]>i&&(a=s+1,i=n[s]):(a=s+1,i=n[s]))}else if(0===t){if("string"==typeof o){if(0===s&&(o="^"+o.replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\?")+"$"),"undefined"!=typeof n[s]&&String(n[s]).toLowerCase().match(String(o).toLowerCase()))return s+1}else if("undefined"!=typeof n[s]&&null!==n[s]&&n[s].valueOf()===o)return s+1}else if(t===-1){if(n[s]===o)return s+1;n[s]>o&&(i?n[s]<i&&(a=s+1,i=n[s]):(a=s+1,i=n[s]))}return a?a:error$2.na}function vlookup(r){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];if(iserror(r)||isblank(r))return r;for(var o=0;o<e.length;o++){var a=e[o];if(t>a.length)return error$2.ref;if(n&&a[0]===r||a[0]==r||"string"==typeof a[0]&&a[0].toLowerCase().indexOf(r.toLowerCase())!=-1)return t<a.length+1?a[t-1]:a[0]}return error$2.na}function date(r,e,t){return serial(new Date(r,e-1,t))}function datevalue(r){return serial(parsedate(r))}function datedif(r,e,t){var n=1e3,o=60*n,a=60*o,i=24*a,s=7*i;r=parsedate(r),e=parsedate(e);var u=e-r;if(Number.isNaN(u))return NaN;switch(t){case"Y":return e.getFullYear()-r.getFullYear();case"M":return 12*e.getFullYear()+e.getMonth()-(12*r.getFullYear()+r.getMonth());case"W":return Math.floor(u/s);case"D":return Math.floor(u/i);case"MD":return e.getdate()-r.getdate();case"YM":return e.getMonth()-r.getMonth();case"YD":return new error("NOT IMPLEMENTED");default:return}}function day(r){return parsedate(r).getDate()}function days360(r,e,t){if(t=parsebool(t),r=parsedate(r),e=parsedate(e),r instanceof Error)return r;if(e instanceof Error)return e;if(t instanceof Error)return t;var n,o,a=r.getMonth(),i=e.getMonth();if(t)n=31===r.getDate()?30:r.getDate(),o=31===e.getDate()?30:e.getDate();else{var s=new Date(r.getFullYear(),a+1,0).getDate(),u=new Date(e.getFullYear(),i+1,0).getDate();n=r.getDate()===s?30:r.getDate(),e.getDate()===u?n<30?(i++,o=1):o=30:o=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(i-a)+(o-n)}function edate(r,e){return r=parsedate(r),r instanceof Error?r:isNaN(e)?error.value:(e=parseInt(e,10),r.setMonth(r.getMonth()+e),serial(r))}function eomonth(r,e){return r=parsedate(r),r instanceof Error?r:isNaN(e)?error$2.value:(e=parseInt(e,10),new Date(r.getFullYear(),r.getMonth()+e+1,0))}function hour(r){return trunc(24*(r-trunc(r)))}function minute(r){var e=(r-trunc(r))*SecondsInDay,t=trunc(e/SecondsInHour)*SecondsInHour;return trunc((e-t)/SecondsInMinute)}function month(r){return parsedate(r).getMonth()+1}function timevalue(r){var e=new Date("1/1/1900 "+r);return e instanceof Error?e:(SecondsInHour*e.getHours()+SecondsInMinute*e.getMinutes()+e.getSeconds())/SecondsInDay}function now(){var r=new Date;return datevalue(r.toLocaleDateString())+timevalue(r.toLocaleTimeString())}function second(r){var e=(r-trunc(r))*SecondsInDay,t=trunc(e/SecondsInHour)*SecondsInHour,n=trunc((e-t)/SecondsInMinute)*SecondsInMinute;return Math.round(e-t-n)}function today(){var r=new Date;return datevalue(r.toLocaleDateString())}function time(r,e,t){return+((3600*r+60*e+t)/SecondsInDay).toFixed(15)}function year(r){return parsedate(r).getFullYear()}function yearfrac(r,e,t){function n(r){return r%4===0&&r%100!==0||r%400===0}function o(r,e){return serial(e)-serial(r)}if(r=parsedate(r),r instanceof Error)return r;if(e=parsedate(e),e instanceof Error)return e;t=t||0;var a=r.getDate(),i=r.getMonth()+1,s=r.getFullYear(),u=e.getDate(),c=e.getMonth()+1,f=e.getFullYear();switch(t){case 0:return 31===a&&31===u?(a=30,u=30):31===a?a=30:30===a&&31===u&&(u=30),(u+30*c+360*f-(a+30*i+360*s))/360;case 1:var l=function(r,e){var t=r.getFullYear(),o=new Date(t,2,1);if(n(t)&&r<o&&e>=o)return!0;var a=e.getFullYear(),i=new Date(a,2,1);return n(a)&&e>=i&&r<i},p=365;if(s===f||s+1===f&&(i>c||i===c&&a>=u))return(s===f&&n(s)||l(r,e)||1===c&&29===u)&&(p=366),o(r,e)/p;var d=f-s+1,m=(new Date(f+1,0,1)-new Date(s,0,1))/1e3/60/60/24,h=m/d;return o(r,e)/h;case 2:return o(r,e)/360;case 3:return o(r,e)/365;case 4:return(u+30*c+360*f-(a+30*i+360*s))/360}}function sum(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return flatten(flatten(e)).reduce(function(r,e){return"number"!=typeof e?error$2.value:r+e})}function average(){var r=sum.apply(void 0,arguments);return iserror(r)?r:r/arguments.length}function min(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=flatten(e);if(0!==n.length)return n.reduce(function(r,e){return isblank(r)?e:isnumber(e)?Math.min(r,e):r})}function max(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=flatten(e);if(0!==n.length)return n.reduce(function(r,e){return isblank(r)?e:isnumber(e)?Math.max(r,e):r})}function fv(r,e,t){var n=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4];if(isblank(r))return error$2.na;if(isblank(e))return error$2.na;if(isblank(t))return error$2.na;var a;if(0===r)a=n+t*e;else{var i=Math.pow(1+r,e);a=1===o?n*i+t*(1+r)*(i-1)/r:n*i+t*(i-1)/r}return-a}function nper(r,e,t,n,o){var a,i;return r=parseFloat(r||0),e=parseFloat(e||0),t=parseFloat(t||0),n=n||0,o=o||0,a=function(r){if(Number.isNaN(r))return Math.log(0);var e=Math.log(r);return e},i=0==r?-(t+n)/e:o>0?a(-(r*n-e*(1+r))/(r*t+e*(1+r)))/a(1+r):a(-(r*n-e)/(r*t+e))/a(1+r),Number.isNaN(i)&&(i=0),i}function npv(r){r=1*r;for(var e=1,t=0,n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];for(var i=0;i<o.length;i++){var e=e*(1+r);t+=o[i]/e}return t}function pmt(r,e,t){var n=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4];if(!isnumber(r)||!isnumber(e))return error$2.value;if(0===r)return-((t+n)/e);var a=Math.pow(1+r,e);return 1===o?-((n*r/(a-1)+t*r/(1-1/a))/(1+r)):-(n*r/(a-1)+t*r/(1-1/a))}function pv(r,e,t){var n=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4];return isblank(r)?error$2.na:isblank(e)?error$2.na:isblank(t)?error$2.na:0===r?-t*e-n:((1-Math.pow(1+r,e))/r*t*(1+r*o)-n)/Math.pow(1+r,e)}function bin2dec(r){var e;if("string"==typeof r)e=r;else{if("undefined"==typeof r)return error$2.NA;e=r.toString()}return e.length>10?error$2.NUM:10===e.length&&"1"===e[0]?parseInt(e.substring(1),2)-512:parseInt(e,2)}function dec2bin(r,e){if(r instanceof Error)return t;var t=parseInt(r);if(!/^-?[0-9]{1,3}$/.test(t)||Number.isNaN(t))return error$2.value;if(t<-512||t>511)return error$2.num;if(t<0)return"1"+rept("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return"undefined"==typeof e?n:!/^-?[0-9]{1,3}$/.test(e)||Number.isNaN(e)?error$2.value:e<0?error$2.num:(e=Math.floor(e),e>=n.length?rept("0",e-n.length)+n:error$2.num)}function oct2dec(r){if(!/^[0-7]{1,10}$/.test(r))return error$2.num;var e=parseInt(r,8);return e>=536870912?e-1073741824:e}function filter(r){function e(){return function(r,e){return n.reduce(function(r,t){return r!==!1&&t[e]},!0)}}for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.filter(e())}function map(r,e){return r.map(function(r){return e(r)})}function pluck(r,e){return isarray(e)?e.map(function(e){return e[r]}):error$2.na}function reduce(r,e){return r.reduce(function(r,t){return e(r,t)})}function some(r,e){return isblank(r)&&isblank(e)?error$2.na:isarray(e)?e.some(function(e){return eq(e,r)}):error$2.na}function sort(r){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];var o=function(){return function(r,e){for(var n=0,o=0;o<t.length;o+2){var a="string"==typeof t[o]?t[o]:t[o]-1,i=t[o+1];return r[a]<e[a]?i?-1:1:i?1:-1}return n}};return isref(r)||isarray(r)?r.sort(o()):error$2.na}function unique(r){return r.reduce(function(r,e){return r.indexOf(e)<0&&r.push(e),r},[])}function changed(r,e){var t=Object.keys(r),n=Object.keys(e);return unique(t.filter(function(t){return r[t]!==e[t]}).concat(n.filter(function(t){return r[t]!==e[t]})))}function diff(r,e){var t=Object.keys(r),n=Object.keys(e),o=n.filter(function(r){return t.indexOf(r)>-1}),a=n.filter(function(r){return t.indexOf(r)===-1}),i=t.filter(function(r){return n.indexOf(r)===-1}),s=o.filter(function(t){return r[t]!==e[t]});return{unique_left:a,unique_right:i,diff:s.reduce(function(t,n){var o={};return o[n]={left:r[n],right:e[n]},Object.assign({},t,o)},{})}}function select(r,e){if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&r)return"string"==typeof r&&(r=r.split(/ *, */)),isarray(e)?e.map(function(e){return r.reduce(function(r,t){return r[t]=e[t],r},{})}):r.reduce(function(r,t){return r[t]=e[t],r},{})}function clean(r){var e=Object.keys(r).filter(function(e){return!isblank(r[e])});return select(e,r)}function get(r,e){return e[r]}function cellindex(r,e){return Math.floor(r*MaxCols+e)}function columnnumber(r){if(!istext(r))return error$2.value;var e,t=0;if(r.length>0){t=r.charCodeAt(0)-"A".charCodeAt(0);for(var n=1;n<r.length;n++)t+=1,t*=26,t+=r.charCodeAt(n)-"A".charCodeAt(0),e=!0;return t}return error$2.value}function column(r){return isref(r)?columnnumber(r.column)+1:error$2.value}function columnletter(r){if(!isnumber(r))return error$2.value;var e,t="",n=!1,o=Math.abs(r);do e=o%26,n&&e--,t=String.fromCharCode(e+"A".charCodeAt(0))+t,o=Math.floor((o-e)/26),n=!0;while(o>0);return t}function decodejwt(r){function e(r){return decodeURIComponent(Array.prototype.map.call(t(r),function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var t;if("undefined"!=typeof window&&"undefined"!=typeof t)t=window.atob;else if("undefined"==typeof t){var n;!function(){var r=function(r){this.message=r};n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r.prototype=new Error,r.prototype.name="InvalidCharacterError",t=function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,a,i=0,s=0,u="";a=t.charAt(s++);~a&&(o=i%4?64*o+a:a,i++%4)?u+=String.fromCharCode(255&o>>(-2*i&6)):0)a=n.indexOf(a);return u}}()}return JSON.parse(e(r.split(".")[1]))}function guid(){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=16*Math.random()|0,t="x"==r?e:3&e|8;return t.toString(16)});return r}function int(r){return Math.floor(r)}function index2row(r){return Math.floor(r/MaxCols)}function index2col(r){return r-index2row(r)*MaxCols}function numbers(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.log(e),e.reduce(function(r,e){return isnumber(e)?r.concat(e):r},[])}function ref$1(r,e){if(!isnumber(r)&&!isfunction(r))return error$2.value;isblank(e)&&(e=r);var t=function(){return isfunction(r)?r():r},n=function(){return isfunction(e)?e():e};return{get _isref(){return!0},get top(){return t()},get bottom(){return n()},get row(){return index2row(t())+1},get rowIndex(){return index2row(t())},get column(){return columnletter(index2col(t()))},get columnIndex(){return index2col(t())},get bottomRow(){return index2row(n())+1},get bottomRowIndex(){return index2row(n())},get bottomColumn(){return columnletter(index2col(n()))},get bottomColumnIndex(){return index2col(n())},hit:function(r){return r<0?error$2.na:r>=t()&&r<=n()},get size(){return 1+(n()-t())},get cells(){return Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return e+t()})},get rows(){return unique(Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return index2row(e+t())}))}}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":typeof r};FFError.prototype=Error.prototype,FFError.prototype.toString=function(){return this.message};var nil=new FFError("#NULL!","Null reference"),div0=new FFError("#DIV/0!","Divide by zero"),value=new FFError("#VALUE!","Invalid value"),ref=new FFError("#REF!","Invalid reference"),name=new FFError("#NAME?","Invalid name"),num=new FFError("#NUM!","Invalid number"),na=new FFError("#N/A!","Not applicable"),error$1=new FFError("#ERROR!","Error"),data=new FFError("#GETTING_DATA!","Error getting data"),missing=new FFError("#MISSING!","Missing"),unknown=new FFError("#UNKNOWN!","Unknown error"),error$2={nil:nil,div0:div0,value:value,ref:ref,name:name,num:num,na:na,error:error$1,data:data,missing:missing,unknown:unknown},d1900=new Date(1900,0,1),JulianOffset=2415019,SecondsInMinute=60,SecondsInHour=3600,SecondsInDay=86400,MilliSecondsInDay=864e5,AllowedDates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"},DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DayNames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],MonthNames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AM="AM",AM1="A",PM="PM",PM1="P",τ=6.28318530717958,MaxCols=16384,SeparatorChar=",",DecimalChar=".",DefaultCurrency="$",AllowedColors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},exact=function(r,e){return r===e},FormatNumber={};FormatNumber.format_definitions={},FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},FormatNumber.formatNumberWithFormat=function(r,e,t){var n,o,a,i,s,u,c,f,l,p,d,m,h,g,x,v,b,y,M,$,w,F,N,A,D,S,k,C,E,O,j,I,L,_,Y,U,T,q,R,H,W=FormatNumber,z="";if(r-=0,H=r,!isFinite(H))return"NaN";var J=H<0?1:0;J&&(H=-H);var P=0==H?1:0;if(t=t||DefaultCurrency,FormatNumber.parse_format_string(W.format_definitions,e),y=W.format_definitions[e],!y)throw"Format not parsed error.";if(M=y.sectioninfo.length-1,y.hascomparison)for(M=0,$=0,N=0;;N++){if(n=y.operators[N],o=y.operands[N],!n){$&&(e="General",W.parse_format_string(W.format_definitions,e),y=W.format_definitions[e],M=0);break}if(n!=W.commands.section){if(n==W.commands.comparison){if(S=o.indexOf(":"),w=o.substring(0,S),F=o.substring(S+1)-0,"<"==w&&r<F||"<="==w&&r<=F||"="==w&&r==F||"<>"==w&&r!=F||">="==w&&r>=F||">"==w&&r>F)break;$=1}}else{if(!$)break;$=0,M++}}else M>0&&(1==M?J?(J=0,M=1):M=0:2==M&&(J?(J=0,M=1):M=P?2:0));if(D=y.sectioninfo[M],D.commas>0)for(S=0;S<D.commas;S++)H/=1e3;if(D.percent>0)for(S=0;S<D.percent;S++)H*=100;for(k=1,S=0;S<D.fractiondigits;S++)k*=10;if(C=Math.floor(H*k+.5),C/=k,"number"!=typeof C)return"NaN";if(!isFinite(C))return"NaN";if(E=C+"",0==C&&(D.fractiondigits||D.integerdigits)&&(J=0),E.indexOf("e")>=0)return r+"";if(O=E.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!O)return"NaN";if(j=O[1],j&&"0"!=j||(j=""),I=O[2],I||(I=""),D.hasdate){if(r<0)return"??-???-?? ??:??:??";for(u=(r-Math.floor(r))*SecondsInDay,c=r*SecondsInDay,f=Math.floor(u/SecondsInHour),d=Math.floor(c/SecondsInHour),u-=f*SecondsInHour,l=Math.floor(u/60),m=Math.floor(c/60),p=u-60*l,k=1,S=0;S<D.fractiondigits;S++)k*=10;for(p=Math.floor(p*k+.5),p/=k,h=Math.floor(c*k+.5),h/=k,p>=60&&(p=0,l++,m++,l>=60&&(l=0,f++,d++,f>=24&&(f=0,r++))),I=p-Math.floor(p)+"",I=I.substring(2),x=parsedate(r),x={year:x.getFullYear(),month:x.getMonth()+1,day:x.getDate()},v=0,b=D.sectionstart;(n=y.operators[b],o=y.operands[b],n)&&n!=W.commands.section;b++)n==W.commands.date?("am/pm"!=o.toLowerCase()&&"a/p"!=o.toLowerCase()||g||(f>=12?(f>12&&(f-=12),g="a/p"==o.toLowerCase()?PM1:PM):(0===f&&(f=12),g="a/p"==o.toLowerCase()?AM1:AM),o.indexOf(g)<0&&(g=g.toLowerCase())),!v||"m"!=o&&"mm"!=o||(y.operands[b]+="in"),v="h"==o.charAt(0)?1:0):n!=W.commands.copy&&(v=0);for(v=0,--b;(n=y.operators[b],o=y.operands[b],n)&&n!=W.commands.section;b--)n==W.commands.date?(!v||"m"!=o&&"mm"!=o||(y.operands[b]+="in"),v="ss"==o?1:0):n!=W.commands.copy&&(v=0)}for(L=0,_=0,Y=0,U="",T="",q=SeparatorChar,q.indexOf(" ")>=0&&(q=q.replace(/ /g," ")),R=DecimalChar,R.indexOf(" ")>=0&&(R=R.replace(/ /g," ")),A=D.sectionstart;n=y.operators[A];)if(o=y.operands[A++],n==W.commands.copy)z+=o;else if(n==W.commands.color)U=o;else if(n==W.commands.style)T=o;else if(n==W.commands.integer_placeholder){if(J&&(z+="-",J=0),L++,1==L&&j.length>D.integerdigits)for(;_<j.length-D.integerdigits;_++)z+=j.charAt(_),D.thousandssep&&(a=j.length-_-1,a>2&&a%3==0&&(z+=q));j.length<D.integerdigits&&L<=D.integerdigits-j.length?"0"!=o&&"?"!=o||(z+="0"==o?"0":" ",D.thousandssep&&(a=D.integerdigits-L,a>2&&a%3==0&&(z+=q))):(z+=j.charAt(_),D.thousandssep&&(a=j.length-_-1,a>2&&a%3==0&&(z+=q)),_++)}else if(n==W.commands.fraction_placeholder)Y>=I.length?"0"!=o&&"?"!=o||(z+="0"==o?"0":" "):z+=I.charAt(Y),Y++;else if(n==W.commands.decimal)J&&(z+="-",J=0),z+=R;else if(n==W.commands.currency)J&&(z+="-",J=0),z+=o;else if(n==W.commands.general){if(0!=H){var B=Math.floor(Math.LOG10E*Math.log(H));if(B=Math.pow(10,13-B),H=Math.floor(B*H+.5)/B,!isFinite(H))return"NaN"}if(J&&(z+="-"),E=H+"",E.indexOf("e")>=0){z+=E;continue}if(O=E.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),j=O[1],j&&"0"!=j||(j=""),I=O[2],I||(I=""),_=0,Y=0,j.length)for(;_<j.length;_++)z+=j.charAt(_),D.thousandssep&&(a=j.length-_-1,a>2&&a%3==0&&(z+=q));else z+="0";if(I.length)for(z+=R;Y<I.length;Y++)z+=I.charAt(Y)}else if(n==W.commands.date)s=o.toLowerCase(),"y"==s||"yy"==s?z+=(x.year+"").substring(2):"yyyy"==s?z+=x.year+"":"d"==s?z+=x.day+"":"dd"==s?(i=1e3+x.day,z+=(i+"").substr(2)):"ddd"==s?(i=Math.floor(r+6)%7,z+=DayNames3[i]):"dddd"==s?(i=Math.floor(r+6)%7,z+=DayNames[i]):"m"==s?z+=x.month+"":"mm"==s?(i=1e3+x.month,z+=(i+"").substr(2)):"mmm"==s?z+=MonthNames3[x.month-1]:"mmmm"==s?z+=MonthNames[x.month-1]:"mmmmm"==s?z+=MonthNames[x.month-1].charAt(0):"h"==s?z+=f+"":"h]"==s?z+=d+"":"mmin"==s?(i=1e3+l+"",z+=i.substr(2)):"mm]"==s?m<100?(i=1e3+m+"",z+=i.substr(2)):z+=m+"":"min"==s?z+=l+"":"m]"==s?z+=m+"":"hh"==s?(i=1e3+f+"",z+=i.substr(2)):"s"==s?(i=Math.floor(p),z+=i+""):"ss"==s?(i=1e3+Math.floor(p)+"",z+=i.substr(2)):"am/pm"==s||"a/p"==s?z+=g:"ss]"==s&&(h<100?(i=1e3+Math.floor(h)+"",z+=i.substr(2)):(i=Math.floor(h),z+=i+""));else{if(n==W.commands.section)break;if(n==W.commands.comparison)continue;z+="!! Parse error.!!"}return U&&(z='<span style="color:'+U+';">'+z+"</span>"),T&&(z='<span style="'+T+';">'+z+"</span>"),z},FormatNumber.parse_format_string=function(r,e){var t,n,o,a,i,s,u,c,f,l,p,d,m,h,g,x,v,b,y=FormatNumber,M=1;if(!r[e]){for(t={operators:[],operands:[],sectioninfo:[{}]},r[e]=t,n=0,o=t.sectioninfo[n],o.sectionstart=0,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,v=0;v<e.length;v++)if(b=e.charAt(v),c){if('"'==b){c=0,t.operators.push(y.commands.copy),t.operands.push(f);continue}f+=b}else if(l){if("]"==b){if(l=0,d=FormatNumber.parse_format_bracket(p),d.operator==y.commands.separator){o.thousandssep=1;continue}d.operator==y.commands.date&&(o.hasdate=1),d.operator==y.commands.comparison&&(t.hascomparison=1),t.operators.push(d.operator),t.operands.push(d.operand);continue}p+=b}else if(i)t.operators.push(y.commands.copy),t.operands.push(b),i=!1;else if(s)t.operators.push(y.commands.copy),t.operands.push(b+b+b+b+b),s=!1;else if(u)t.operators.push(y.commands.copy),t.operands.push(" "),u=!1;else{if(m){if("general".charAt(m)==b.toLowerCase()){m++,7==m&&(t.operators.push(y.commands.general),t.operands.push(b),m=0);continue}m=0}if(x){if(x.charAt(0)==b){x+=b;continue}t.operators.push(y.commands.date),t.operands.push(x),o.hasdate=1,x=""}h?(h+=b,g=h.toLowerCase(),g!="am/pm".substring(0,g.length)&&g!="a/p".substring(0,g.length)?ampstr="":"am/pm"!=g&&"a/p"!=g||(t.operators.push(y.commands.date),t.operands.push(h),h="")):"#"==b||"0"==b||"?"==b?M?(o.integerdigits++,o.commas&&(o.thousandssep=1,o.commas=0),a=1,t.operators.push(y.commands.integer_placeholder),t.operands.push(b)):(o.fractiondigits++,t.operators.push(y.commands.fraction_placeholder),t.operands.push(b)):"."==b?(a=0,t.operators.push(y.commands.decimal),t.operands.push(b),M=0):"$"===b?(a=0,t.operators.push(y.commands.currency),t.operands.push(b)):","==b?a?o.commas++:(t.operators.push(y.commands.copy),t.operands.push(b)):"%"==b?(a=0,o.percent++,t.operators.push(y.commands.copy),t.operands.push(b)):'"'==b?(a=0,c=1,f=""):"["==b?(a=0,l=1,p=""):"\\"==b?(i=1,a=0):"*"==b?(s=1,a=0):"_"==b?(u=1,a=0):";"==b?(n++,t.sectioninfo[n]={},o=t.sectioninfo[n],o.sectionstart=1+t.operators.length,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,M=1,a=0,t.operators.push(y.commands.section),t.operands.push(b)):"g"==b.toLowerCase()?(m=1,a=0):"a"==b.toLowerCase()?(h=b,a=0):"dmyhHs".indexOf(b)>=0?x=b:(a=0,t.operators.push(y.commands.copy),t.operands.push(b))}x&&(t.operators.push(y.commands.date),t.operands.push(x),o.hasdate=1)}},FormatNumber.parse_format_bracket=function(r){var e,t=FormatNumber,n={};return"$"==r.charAt(0)?(n.operator=t.commands.currency,e=r.match(/^\$(.+?)(\-.+?){0,1}$/),
e?n.operand=e[1]||DefaultCurrency||"$":n.operand=r.substring(1)||DefaultCurrency||"$"):"?$"==r?(n.operator=t.commands.currency,n.operand="[?$]"):AllowedColors[r.toUpperCase()]?(n.operator=t.commands.color,n.operand=AllowedColors[r.toUpperCase()]):(e=r.match(/^style=([^']*)$/))?(n.operator=t.commands.style,n.operand=e[1]):","==r?(n.operator=t.commands.separator,n.operand=r):AllowedDates[r.toUpperCase()]?(n.operator=t.commands.date,n.operand=AllowedDates[r.toUpperCase()]):(e=r.match(/^[<>=]/))?(e=r.match(/^([<>=]+)(.+)$/),n.operator=t.commands.comparison,n.operand=e[1]+":"+e[2]):(n.operator=t.commands.copy,n.operand="["+r+"]"),n},Number.isNaN=Number.isNaN||function(r){return r!==r},exports.branch=branch,exports.cond=branch,exports.choose=choose,exports.and=and,exports.or=or,exports.not=not,exports.eq=eq,exports.ne=ne,exports.gt=gt,exports.gte=gte,exports.lt=lt,exports.lte=lte,exports.ifblank=ifblank,exports.ifBlank=ifblank,exports.ifempty=ifempty,exports.ifEmpty=ifempty,exports.iferror=iferror,exports.ifError=iferror,exports.ifna=ifna,exports.ifNA=ifna,exports.isarray=isarray,exports.isArray=isarray,exports.isblank=isblank,exports.isBlank=isblank,exports.isboolean=isboolean,exports.isbool=isboolean,exports.isBoolean=isboolean,exports.isBool=isboolean,exports.isdate=isdate,exports.isDate=isdate,exports.isemail=isemail,exports.isEmail=isemail,exports.isempty=isempty,exports.isEmpty=isempty,exports.iserror=iserror,exports.isError=iserror,exports.iseven=iseven,exports.isEven=iseven,exports.isfunction=isfunction,exports.isFunction=isfunction,exports.isleapyear=isleapyear,exports.isLeapYear=isleapyear,exports.isna=isna,exports.isNA=isna,exports.isnumber=isnumber,exports.isNumber=isnumber,exports.isodd=isodd,exports.isOdd=isodd,exports.isoweeknum=isoweeknum,exports.isoWeekNum=isoweeknum,exports.isref=isref,exports.isRef=isref,exports.istext=istext,exports.isText=istext,exports.isurl=isurl,exports.ISURL=isurl,exports.iswholenumber=iswholenumber,exports.isWholeNumber=iswholenumber,exports.isInteger=iswholenumber,exports.xor=xor,exports.add=add,exports.subtract=subtract,exports.multiply=multiply,exports.divide=divide,exports.abs=abs,exports.acos=acos,exports.cos=cos,exports.pi=pi,exports.power=power,exports.round=round,exports.roundup=roundup,exports.sin=sin,exports.tan=tan,exports.tau=tau,exports.trunc=trunc,exports.char=char,exports.code=code,exports.concatenate=concatenate,exports.concat=concatenate,exports.exact=exact,exports.find=find,exports.join=join,exports.left=left,exports.len=len,exports.lower=lower,exports.numbervalue=numbervalue,exports.numberValue=numbervalue,exports.parsebool=parsebool,exports.parseBool=parsebool,exports.parsedate=parsedate,exports.parseDate=parsedate,exports.parsequery=parsequery,exports.parseQuery=parsequery,exports.proper=proper,exports.replace=replace,exports.right=right,exports.rept=rept,exports.search=search,exports.substitute=substitute,exports.substituteAll=substituteAll,exports.template=substituteAll,exports.surroundKeys=surroundKeys,exports.split=split,exports.text=text,exports.trim=trim,exports.upper=upper,exports.hlookup=hlookup,exports.index=index,exports.lookup=lookup,exports.match=match,exports.vlookup=vlookup,exports.date=date,exports.datevalue=datevalue,exports.dateValue=datevalue,exports.datedif=datedif,exports.day=day,exports.days360=days360,exports.edate=edate,exports.eomonth=eomonth,exports.hour=hour,exports.minute=minute,exports.month=month,exports.now=now,exports.second=second,exports.today=today,exports.time=time,exports.timevalue=timevalue,exports.year=year,exports.yearfrac=yearfrac,exports.average=average,exports.min=min,exports.max=max,exports.sum=sum,exports.fv=fv,exports.nper=nper,exports.npv=npv,exports.pmt=pmt,exports.pv=pv,exports.bin2dec=bin2dec,exports.dec2bin=dec2bin,exports.oct2dec=oct2dec,exports.filter=filter,exports.flatten=flatten,exports.map=map,exports.pluck=pluck,exports.reduce=reduce,exports.some=some,exports.in=some,exports.sort=sort,exports.unique=unique,exports.changed=changed,exports.diff=diff,exports.clean=clean,exports.get=get,exports.select=select,exports.cellindex=cellindex,exports.cellIndex=cellindex,exports.column=column,exports.columnletter=columnletter,exports.columnLetter=columnletter,exports.columnnumber=columnnumber,exports.decodejwt=decodejwt,exports.decodeJWT=decodejwt,exports.guid=guid,exports.int=int,exports.index2col=index2col,exports.index2row=index2row,exports.n=n,exports.numbers=numbers,exports.ref=ref$1,exports.serial=serial;
},{}]},{},[1]);
