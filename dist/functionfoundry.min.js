(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
window&&(Number.isNaN=Number.isNaN||function(n){return n!==n},window.FunctionFoundry=require("./lib/functionfoundry"));
},{"./lib/functionfoundry":2}],2:[function(require,module,exports){
"use strict";function isnumber(r){return"number"==typeof r&&!Number.isNaN(r)&&isFinite(r)}function FFError(r){this.name="NotImplementedError",this.message=r||""}function abs(r){return isnumber(r)?Math.abs(r):error$2.value}function acos(r){return isnumber(r)?Math.acos(r):error$2.value}function add(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?n+o:error$2.value}function and(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return e!==!0&&e!==!1&&1!==e&&0!==e?error$2.value:r===error$2.value?error$2.value:r===!1?!1:e===!0||1===e})}function flatten(r){return r.reduce(function(r,e){return r.concat(e)},[])}function sum(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return flatten(flatten(e)).reduce(function(r,e){return"number"!=typeof e?error$2.value:r+e})}function iserr(r){return r!==error$2.na&&"Error"===r.constructor.name||"number"==typeof r&&(Number.isNaN(r)||!Number.isFinite(r))}function iserror(r){return iserr(r)||r===error$2.na}function average(){var r=sum.apply(void 0,arguments);return iserror(r)?r:r/arguments.length}function bin2dec(r){var e;if("string"==typeof r)e=r;else{if("undefined"==typeof r)return error$2.NA;e=r.toString()}return e.length>10?error$2.NUM:10===e.length&&"1"===e[0]?parseInt(e.substring(1),2)-512:parseInt(e,2)}function branch(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=!1;return e.reduce(function(r,t,o){if(n===!0)return r;if(o===e.length-1){if(o%2===1)return;return t}return o%2===0&&t===!0?(n=!0,e[o+1]):r},void 0)}function cellindex(r,e){return Math.floor(r*MaxCols+e)}function unique(r){return r.reduce(function(r,e){return r.indexOf(e)<0&&r.push(e),r},[])}function changed(r,e){var t=Object.keys(r),n=Object.keys(e);return unique(t.filter(function(t){return r[t]!==e[t]}).concat(n.filter(function(t){return r[t]!==e[t]})))}function choose(r){return r&&arguments.length-1!==0?1>r||r>254?error$2.value:arguments.length-1<r?error$2.value:arguments.length<=r-1+1?void 0:arguments[r-1+1]:error$2.na}function isblank(r){return"undefined"==typeof r||null===r}function isarray(r){return"[object Array]"===Object.prototype.toString.call(r)}function select(r,e){return e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&r?("string"==typeof r&&(r=r.split(/ *, */)),isarray(e)?e.map(function(e){return r.reduce(function(r,t){return r[t]=e[t],r},{})}):r.reduce(function(r,t){return r[t]=e[t],r},{})):void 0}function clean(r){var e=Object.keys(r).filter(function(e){return!isblank(r[e])});return select(e,r)}function code(){var r=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=arguments.length<=1||void 0===arguments[1]?1:arguments[1];return 1>e?error$2.na:r.length<e?error$2.value:r.charCodeAt(e-1)}function istext(r){return"string"==typeof r}function isref(r){return r?r._isref===!0:!1}function columnnumber(r){if(!istext(r))return error$2.value;var e,t=0;if(r.length>0){t=r.charCodeAt(0)-"A".charCodeAt(0);for(var n=1;n<r.length;n++)t+=1,t*=26,t+=r.charCodeAt(n)-"A".charCodeAt(0),e=!0;return t}return error$2.value}function column(r){return isref(r)?columnnumber(r.column)+1:error$2.value}function columnletter(r){if(!isnumber(r))return error$2.value;var e,t="",n=!1,o=Math.abs(r);do e=o%26,n&&e--,t=String.fromCharCode(e+"A".charCodeAt(0))+t,o=Math.floor((o-e)/26),n=!0;while(o>0);return t}function concatenate(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return""+r+e})}function cos(r){return isnumber(r)?Math.cos(r):error$2.value}function isdate(r){return r&&"[object Date]"==Object.prototype.toString.call(r)}function serial(r){if(!isdate(r))return error$2.na;var e=Math.ceil((r-d1900)/MilliSecondsInDay);return e+(e>59?2:1)}function date(r,e,t){return serial(new Date(r,e-1,t))}function parsedate(r){function e(r){var e,t,n,o,a;return e=r+68569,t=Math.floor(4*e/146097),e-=Math.floor((146097*t+3)/4),n=Math.floor(4e3*(e+1)/1461001),e=e-Math.floor(1461*n/4)+31,o=Math.floor(80*e/2447),a=e-Math.floor(2447*o/80),e=Math.floor(o/11),o=o+2-12*e,n=100*(t-49)+n+e,new Date(n,o-1,a)}if(r instanceof Error)return r;if("number"==typeof r)return e(Math.floor(r+JulianOffset));if("string"==typeof r){var t=Date.parse(r);return Number.isNaN(t)?error$2.value:new Date(t)}return error$2.value}function datevalue(r){return serial(parsedate(r))}function datedif(r,e,t){var n=1e3,o=60*n,a=60*o,i=24*a,s=7*i;r=parsedate(r),e=parsedate(e);var u=e-r;if(Number.isNaN(u))return NaN;switch(t){case"Y":return e.getFullYear()-r.getFullYear();case"M":return 12*e.getFullYear()+e.getMonth()-(12*r.getFullYear()+r.getMonth());case"W":return Math.floor(u/s);case"D":return Math.floor(u/i);case"MD":return e.getdate()-r.getdate();case"YM":return e.getMonth()-r.getMonth();case"YD":return new error("NOT IMPLEMENTED");default:return}}function parsebool(r){if(r instanceof Error)return r;if("boolean"==typeof r)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){var e=r.toUpperCase();if("TRUE"===e||"FALSE"===e)return"TRUE"===e}return error$2.value}function days360(r,e,t){if(t=parsebool(t),r=parsedate(r),e=parsedate(e),r instanceof Error)return r;if(e instanceof Error)return e;if(t instanceof Error)return t;var n,o,a=r.getMonth(),i=e.getMonth();if(t)n=31===r.getDate()?30:r.getDate(),o=31===e.getDate()?30:e.getDate();else{var s=new Date(r.getFullYear(),a+1,0).getDate(),u=new Date(e.getFullYear(),i+1,0).getDate();n=r.getDate()===s?30:r.getDate(),e.getDate()===u?30>n?(i++,o=1):o=30:o=e.getDate()}return 360*(e.getFullYear()-r.getFullYear())+30*(i-a)+(o-n)}function rept(r,e){for(var t="",n=0;e>n;n++)t+=r;return t}function dec2bin(r,e){if(r instanceof Error)return t;var t=parseInt(r);if(!/^-?[0-9]{1,3}$/.test(t)||Number.isNaN(t))return error$2.value;if(-512>t||t>511)return error$2.num;if(0>t)return"1"+rept("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return"undefined"==typeof e?n:!/^-?[0-9]{1,3}$/.test(e)||Number.isNaN(e)?error$2.value:0>e?error$2.num:(e=Math.floor(e),e>=n.length?rept("0",e-n.length)+n:error$2.num)}function diff(r,e){var t=Object.keys(r),n=Object.keys(e),o=n.filter(function(r){return t.indexOf(r)>-1}),a=n.filter(function(r){return-1===t.indexOf(r)}),i=t.filter(function(r){return-1===n.indexOf(r)}),s=o.filter(function(t){return r[t]!==e[t]});return{unique_left:a,unique_right:i,diff:s.reduce(function(t,n){var o={};return o[n]={left:r[n],right:e[n]},Object.assign({},t,o)},{})}}function divide(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return 0===o?error$2.div0:isnumber(n)&&isnumber(o)?n/o:error$2.value}function eq(r,e){return"string"==typeof r&&"string"==typeof e?r.toLowerCase()===e.toLowerCase():r===e}function filter(r){function e(){return function(r,e){return n.reduce(function(r,t){return r===!1?!1:t[e]},!0)}}for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;t>o;o++)n[o-1]=arguments[o];return r.filter(e())}function find(r){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t=e.indexOf(r,t-1),-1===t?error$2.value:t+1}function gt(r,e){return isref(r)&&isref(e)?error$2.na:isarray(r)&&isarray(e)?error$2.na:isref(r)||isarray(r)?r.map(function(r){return r>e}):isref(e)||isarray(e)?e.map(function(e){return e>r}):r>e}function gte(r,e){return isref(r)&&isref(e)?error.na:isarray(r)&&isarray(e)?error.na:isref(r)||isarray(r)?r.map(function(r){return r>=e}):isref(e)||isarray(e)?e.map(function(e){return e>=r}):r>=e}function guid(){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=16*Math.random()|0,t="x"==r?e:3&e|8;return t.toString(16)});return r}function hlookup(r,e){var t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=arguments[3];if("undefined"==typeof r||isblank(r))return null;if(t>e.length)return error$2.ref;for(var o=(r+"").toLowerCase(),a=e[0],i=0;i<a.length;i++)if(n&&a[i]===r||a[i]==r||"string"==typeof a[i]&&-1!=a[i].toLowerCase().indexOf(o))return e[t-1][i];return error$2.na}function ifblank(r,e){return isblank(r)?e:r}function isempty(r){return isblank(r)||isarray(r)&&0===r.length||istext(r)&&""===r}function ifempty(r,e){return isempty(r)?e:r}function iferror(r){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return iserror(r)?e:r}function ifna(r,e){return r===error$2.na?e:r}function index2row(r){return Math.floor(r/MaxCols)}function index2col(r){return r-index2row(r)*MaxCols}function isfunction(r){return r&&"[object Function]"==Object.prototype.toString.call(r)}function ref$1(r,e){if(!isnumber(r)&&!isfunction(r))return error$2.value;isblank(e)&&(e=r);var t=function(){return isfunction(r)?r():r},n=function(){return isfunction(e)?e():e};return{get _isref(){return!0},get top(){return t()},get bottom(){return n()},get row(){return index2row(t())+1},get rowIndex(){return index2row(t())},get column(){return columnletter(index2col(t()))},get columnIndex(){return index2col(t())},get bottomRow(){return index2row(n())+1},get bottomRowIndex(){return index2row(n())},get bottomColumn(){return columnletter(index2col(n()))},get bottomColumnIndex(){return index2col(n())},hit:function(r){return 0>r?error$2.na:r>=t()&&r<=n()},get size(){return 1+(n()-t())},get cells(){return Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return e+t()})},get rows(){return unique(Array.apply(t(),Array(1+(n()-t()))).map(function(r,e){return index2row(e+t())}))}}}function indirect(r){return r(r)}function isemail(r){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(r)}function iseven(r){return!(1&Math.floor(Math.abs(r)))}function isna(r){return r===error$2.na}function isodd(r){return!!(1&Math.floor(Math.abs(r)))}function isurl(r){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(r)}function len(r){return 0===arguments.length?error$2.error:"string"==typeof r?r.length:r.length?r.length:error$2.value}function lookup(){var r,e,t,n;if(2===arguments.length){r=arguments[0].valueOf(),e=arguments[1];for(var o=0;o<e.length;o++)if("undefined"!=typeof e[o]&&r===e[o].valueOf())return e[o]}else if(3===arguments.length){r=arguments[0].valueOf(),t=arguments[1],n=arguments[2];for(var o=0;o<t.length;o++)if("undefined"!=typeof t[o]&&r===t[o].valueOf())return n[o]}return error.na}function lower(r){return istext(r)?r.toLowerCase():error$2.value}function lt(r,e){return isref(r)&&isref(e)?error.na:isarray(r)&&isarray(e)?error.na:isref(r)||isarray(r)?r.map(function(r){return e>r}):isref(e)||isarray(e)?e.map(function(e){return r>e}):e>r}function lte(r,e){return isref(r)&&isref(e)?error.na:isarray(r)&&isarray(e)?error.na:isref(r)||isarray(r)?r.map(function(r){return e>=r}):isref(e)||isarray(e)?e.map(function(e){return r>=e}):e>=r}function min(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return flatten(e).reduce(function(r,e){return isnumber(e)?Math.min(r,e):r},Number.POSITIVE_INFINITY)}function max(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return flatten(e).reduce(function(r,e){return isnumber(e)?Math.max(r,e):r},Number.NEGATIVE_INFINITY)}function multiply(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?n*o:error$2.value}function n(r){return isnumber(r)||iserror(r)?r:r instanceof Date?serial(r):r===!0?1:0}function numbervalue(r,e,t){if(e=e||".",t=t||",",isempty(r))return error$2.value;if(isnumber(r))return r;var n=!1,o=r.length-1;return r.split("").reduce(function(r,a,i){return r===error$2.value?error$2.value:o===i?"%"===a?+r/100:+r.concat(a):a===e?n?error$2.value:(n=!0,r.concat(".")):a===t?r:a.charCodeAt(0)<48||a.charCodeAt(0)>57?error$2.value:r.concat(a)})}function ne(r,e){return!eq(r,e)}function not(r){return r!==!0&&r!==!1&&1!==r&&0!==r?error$2.value:!r}function oct2dec(r){if(!/^[0-7]{1,10}$/.test(r))return error$2.num;var e=parseInt(r,8);return e>=536870912?e-1073741824:e}function or(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.reduce(function(r,e){return r===!0?!0:e===!0||1===e},!1)}function pi(){return τ/2}function pmt(r,e,t){var n=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4];if(!isnumber(r)||!isnumber(e))return error$2.value;if(0===r)return-((t+n)/e);var a=Math.pow(1+r,e);return 1===o?-((n*r/(a-1)+t*r/(1-1/a))/(1+r)):-(n*r/(a-1)+t*r/(1-1/a))}function power(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?Math.pow(n,o):error$2.value}function replace(r,e,t,n){return iserror(e)||iserror(t)||"string"!=typeof r||"string"!=typeof n?error$2.value:r.substr(0,e-1)+n+r.substr(e-1+t)}function right(r,e){return isblank(r)?"":n(+e)?r.substring(r.length-e):r}function round(r,e){return+r.toFixed(e)}function roundup(r,e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9],n=t[e];return r>0?Math.ceil(r*n)/n:Math.floor(r*n)/n}function search(r,e,t){if(!e)return null;t="undefined"==typeof t?1:t;var n=r.replace(/([^~])\?/g,"$1.").replace(/([^~])\*/g,"$1.*").replace(/([~])\?/g,"\\?").replace(/([~])\*/g,"\\*");return t=new RegExp(n,"i").exec(e),t?t.index+1:error$2.value}function sin(r){return isnumber(r)?Math.sin(r):error$2.value}function some(r,e){return isblank(r)&&isblank(e)?error$2.na:isarray(e)?e.some(function(e){return eq(e,r)}):error$2.na}function sort(r){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];var o=function(){return function(r,e){for(var n=0,o=0;o<t.length;o+2){var a="string"==typeof t[o]?t[o]:t[o]-1,i=t[o+1];return r[a]<e[a]?i?-1:1:i?1:-1}return n}};return isref(r)||isarray(r)?r.sort(o()):error$2.na}function split(r,e){return r.split(e)}function substitute(r,e,t,n){if(!(r&&e&&t))return r;if(void 0===n)return r.replace(new RegExp(e,"g"),t);for(var o=0,a=0;r.indexOf(e,o)>0;)if(o=r.indexOf(e,o+1),a++,a===n)return r.substring(0,o)+t+r.substring(o+e.length)}function subtract(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];if(2!==e.length)return error$2.na;var n=e[0],o=e[1];return isnumber(n)&&isnumber(o)?n-o:error$2.value}function tan(r){return isnumber(r)?Math.tan(r):error$2.value}function tau(){return τ}function text(r,e,t){return FormatNumber.formatNumberWithFormat(r,e,t)}function trim(r){return"string"!=typeof r?error$2.value:r.trim()}function upper(r){return r.toUpperCase()}function vlookup(r){var e=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(iserror(r)||isblank(r))return r;for(var o=0;o<e.length;o++){var a=e[o];if(t>a.length)return error$2.ref;if(n&&a[0]===r||a[0]==r||"string"==typeof a[0]&&-1!=a[0].toLowerCase().indexOf(r.toLowerCase()))return t<a.length+1?a[t-1]:a[0]}return error$2.na}function xor(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return!!(1&flatten(e).reduce(function(r,e){return e?r+1:r},0))}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":typeof r};FFError.prototype=Error.prototype,FFError.prototype.toString=function(){return this.message};var nil=new FFError("#NULL!"),div0=new FFError("#DIV/0!"),value=new FFError("#VALUE!"),ref=new FFError("#REF!"),name=new FFError("#NAME?"),num=new FFError("#NUM!"),na=new FFError("#N/A!"),error$1=new FFError("#ERROR!"),data=new FFError("#GETTING_DATA!"),missing=new FFError("#MISSING!"),unknown=new FFError("#UNKNOWN!"),error$2={nil:nil,div0:div0,value:value,ref:ref,name:name,num:num,na:na,error:error$1,data:data,missing:missing,unknown:unknown},d1900=new Date(1900,0,1),JulianOffset=2415019,SecondsInHour=3600,SecondsInDay=86400,MilliSecondsInDay=864e5,DayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DayNames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],MonthNames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AM="AM",AM1="A",PM="PM",PM1="P",τ=6.28318530717958,MaxCols=16384,SeparatorChar=",",DecimalChar=".",DefaultCurrency="$",AllowedColors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},exact=function(r,e){return r===e},FormatNumber={};FormatNumber.format_definitions={},FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},FormatNumber.formatNumberWithFormat=function(r,e,t){var n,o,a,i,s,u,c,f,l,p,d,m,h,g,x,b,y,v,M,$,F,N,A,w,O,C,E,D,j,k,S,_,I,L,T,Y,U,q,R,P,z=FormatNumber,G="";if(r-=0,P=r,!isFinite(P))return"NaN";var J=0>P?1:0;J&&(P=-P);var W=0==P?1:0;if(t=t||DefaultCurrency,FormatNumber.parse_format_string(z.format_definitions,e),v=z.format_definitions[e],!v)throw"Format not parsed error.";if(M=v.sectioninfo.length-1,v.hascomparison)for(M=0,$=0,A=0;;A++){if(n=v.operators[A],o=v.operands[A],!n){$&&(e="General",z.parse_format_string(z.format_definitions,e),v=z.format_definitions[e],M=0);break}if(n!=z.commands.section){if(n==z.commands.comparison){if(C=o.indexOf(":"),F=o.substring(0,C),N=o.substring(C+1)-0,"<"==F&&N>r||"<="==F&&N>=r||"="==F&&r==N||"<>"==F&&r!=N||">="==F&&r>=N||">"==F&&r>N)break;$=1}}else{if(!$)break;$=0,M++}}else M>0&&(1==M?J?(J=0,M=1):M=0:2==M&&(J?(J=0,M=1):M=W?2:0));if(O=v.sectioninfo[M],O.commas>0)for(C=0;C<O.commas;C++)P/=1e3;if(O.percent>0)for(C=0;C<O.percent;C++)P*=100;for(E=1,C=0;C<O.fractiondigits;C++)E*=10;if(D=Math.floor(P*E+.5),D/=E,"number"!=typeof D)return"NaN";if(!isFinite(D))return"NaN";if(j=D+"",0==D&&(O.fractiondigits||O.integerdigits)&&(J=0),j.indexOf("e")>=0)return r+"";if(k=j.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!k)return"NaN";if(S=k[1],S&&"0"!=S||(S=""),_=k[2],_||(_=""),O.hasdate){if(0>r)return"??-???-?? ??:??:??";for(u=(r-Math.floor(r))*SecondsInDay,c=r*SecondsInDay,f=Math.floor(u/SecondsInHour),d=Math.floor(c/SecondsInHour),u-=f*SecondsInHour,l=Math.floor(u/60),m=Math.floor(c/60),p=u-60*l,E=1,C=0;C<O.fractiondigits;C++)E*=10;for(p=Math.floor(p*E+.5),p/=E,h=Math.floor(c*E+.5),h/=E,p>=60&&(p=0,l++,m++,l>=60&&(l=0,f++,d++,f>=24&&(f=0,r++))),_=p-Math.floor(p)+"",_=_.substring(2),x=parsedate(r),x={year:x.getFullYear(),month:x.getMonth()+1,day:x.getDate()},b=0,y=O.sectionstart;(n=v.operators[y],o=v.operands[y],n)&&n!=z.commands.section;y++)n==z.commands.date?("am/pm"!=o.toLowerCase()&&"a/p"!=o.toLowerCase()||g||(f>=12?(f-=12,g="a/p"==o.toLowerCase()?PM1:PM):g="a/p"==o.toLowerCase()?AM1:AM,o.indexOf(g)<0&&(g=g.toLowerCase())),!b||"m"!=o&&"mm"!=o||(v.operands[y]+="in"),b="h"==o.charAt(0)?1:0):n!=z.commands.copy&&(b=0);for(b=0,--y;(n=v.operators[y],o=v.operands[y],n)&&n!=z.commands.section;y--)n==z.commands.date?(!b||"m"!=o&&"mm"!=o||(v.operands[y]+="in"),b="ss"==o?1:0):n!=z.commands.copy&&(b=0)}for(I=0,L=0,T=0,Y="",U="",q=SeparatorChar,q.indexOf(" ")>=0&&(q=q.replace(/ /g," ")),R=DecimalChar,R.indexOf(" ")>=0&&(R=R.replace(/ /g," ")),w=O.sectionstart;n=v.operators[w];)if(o=v.operands[w++],n==z.commands.copy)G+=o;else if(n==z.commands.color)Y=o;else if(n==z.commands.style)U=o;else if(n==z.commands.integer_placeholder){if(J&&(G+="-",J=0),I++,1==I&&S.length>O.integerdigits)for(;L<S.length-O.integerdigits;L++)G+=S.charAt(L),O.thousandssep&&(a=S.length-L-1,a>2&&a%3==0&&(G+=q));S.length<O.integerdigits&&I<=O.integerdigits-S.length?"0"!=o&&"?"!=o||(G+="0"==o?"0":" ",O.thousandssep&&(a=O.integerdigits-I,a>2&&a%3==0&&(G+=q))):(G+=S.charAt(L),O.thousandssep&&(a=S.length-L-1,a>2&&a%3==0&&(G+=q)),L++)}else if(n==z.commands.fraction_placeholder)T>=_.length?"0"!=o&&"?"!=o||(G+="0"==o?"0":" "):G+=_.charAt(T),T++;else if(n==z.commands.decimal)J&&(G+="-",J=0),G+=R;else if(n==z.commands.currency)J&&(G+="-",J=0),G+=o;else if(n==z.commands.general){if(0!=P){var H=Math.floor(Math.LOG10E*Math.log(P));if(H=Math.pow(10,13-H),P=Math.floor(H*P+.5)/H,!isFinite(P))return"NaN"}if(J&&(G+="-"),j=P+"",j.indexOf("e")>=0){G+=j;continue}if(k=j.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),S=k[1],S&&"0"!=S||(S=""),_=k[2],_||(_=""),L=0,T=0,S.length)for(;L<S.length;L++)G+=S.charAt(L),O.thousandssep&&(a=S.length-L-1,a>2&&a%3==0&&(G+=q));else G+="0";if(_.length)for(G+=R;T<_.length;T++)G+=_.charAt(T)}else if(n==z.commands.date)s=o.toLowerCase(),"y"==s||"yy"==s?G+=(x.year+"").substring(2):"yyyy"==s?G+=x.year+"":"d"==s?G+=x.day+"":"dd"==s?(i=1e3+x.day,G+=(i+"").substr(2)):"ddd"==s?(i=Math.floor(r+6)%7,G+=DayNames3[i]):"dddd"==s?(i=Math.floor(r+6)%7,G+=DayNames[i]):"m"==s?G+=x.month+"":"mm"==s?(i=1e3+x.month,G+=(i+"").substr(2)):"mmm"==s?G+=MonthNames3[x.month-1]:"mmmm"==s?G+=MonthNames[x.month-1]:"mmmmm"==s?G+=MonthNames[x.month-1].charAt(0):"h"==s?G+=f+"":"h]"==s?G+=d+"":"mmin"==s?(i=1e3+l+"",G+=i.substr(2)):"mm]"==s?100>m?(i=1e3+m+"",G+=i.substr(2)):G+=m+"":"min"==s?G+=l+"":"m]"==s?G+=m+"":"hh"==s?(i=1e3+f+"",G+=i.substr(2)):"s"==s?(i=Math.floor(p),G+=i+""):"ss"==s?(i=1e3+Math.floor(p)+"",G+=i.substr(2)):"am/pm"==s||"a/p"==s?G+=g:"ss]"==s&&(100>h?(i=1e3+Math.floor(h)+"",G+=i.substr(2)):(i=Math.floor(h),G+=i+""));else{if(n==z.commands.section)break;if(n==z.commands.comparison)continue;G+="!! Parse error.!!"}return Y&&(G='<span style="color:'+Y+';">'+G+"</span>"),U&&(G='<span style="'+U+';">'+G+"</span>"),G},FormatNumber.parse_format_string=function(r,e){var t,n,o,a,i,s,u,c,f,l,p,d,m,h,g,x,b,y,v=FormatNumber,M=1;if(!r[e]){for(t={operators:[],operands:[],sectioninfo:[{}]},r[e]=t,n=0,o=t.sectioninfo[n],o.sectionstart=0,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,b=0;b<e.length;b++)if(y=e.charAt(b),c){if('"'==y){c=0,t.operators.push(v.commands.copy),t.operands.push(f);continue}f+=y}else if(l){if("]"==y){if(l=0,d=FormatNumber.parse_format_bracket(p),d.operator==v.commands.separator){o.thousandssep=1;continue}d.operator==v.commands.date&&(o.hasdate=1),d.operator==v.commands.comparison&&(t.hascomparison=1),t.operators.push(d.operator),t.operands.push(d.operand);continue}p+=y}else if(i)t.operators.push(v.commands.copy),t.operands.push(y),i=!1;else if(s)t.operators.push(v.commands.copy),t.operands.push(y+y+y+y+y),s=!1;else if(u)t.operators.push(v.commands.copy),t.operands.push(" "),u=!1;else{if(m){if("general".charAt(m)==y.toLowerCase()){m++,7==m&&(t.operators.push(v.commands.general),t.operands.push(y),m=0);continue}m=0}if(x){if(x.charAt(0)==y){x+=y;continue}t.operators.push(v.commands.date),t.operands.push(x),o.hasdate=1,x=""}h?(h+=y,g=h.toLowerCase(),g!="am/pm".substring(0,g.length)&&g!="a/p".substring(0,g.length)?ampstr="":"am/pm"!=g&&"a/p"!=g||(t.operators.push(v.commands.date),t.operands.push(h),h="")):"#"==y||"0"==y||"?"==y?M?(o.integerdigits++,o.commas&&(o.thousandssep=1,o.commas=0),a=1,t.operators.push(v.commands.integer_placeholder),t.operands.push(y)):(o.fractiondigits++,t.operators.push(v.commands.fraction_placeholder),t.operands.push(y)):"."==y?(a=0,t.operators.push(v.commands.decimal),t.operands.push(y),M=0):"$"===y?(a=0,t.operators.push(v.commands.currency),t.operands.push(y)):","==y?a?o.commas++:(t.operators.push(v.commands.copy),t.operands.push(y)):"%"==y?(a=0,o.percent++,t.operators.push(v.commands.copy),t.operands.push(y)):'"'==y?(a=0,c=1,f=""):"["==y?(a=0,l=1,p=""):"\\"==y?(i=1,a=0):"*"==y?(s=1,a=0):"_"==y?(u=1,a=0):";"==y?(n++,t.sectioninfo[n]={},o=t.sectioninfo[n],o.sectionstart=1+t.operators.length,o.integerdigits=0,o.fractiondigits=0,o.commas=0,o.percent=0,M=1,a=0,t.operators.push(v.commands.section),t.operands.push(y)):"g"==y.toLowerCase()?(m=1,a=0):"a"==y.toLowerCase()?(h=y,a=0):"dmyhHs".indexOf(y)>=0?x=y:(a=0,t.operators.push(v.commands.copy),t.operands.push(y))}x&&(t.operators.push(v.commands.date),t.operands.push(x),o.hasdate=1)}},FormatNumber.parse_format_bracket=function(r){var e,t=FormatNumber,n={};return"$"==r.charAt(0)?(n.operator=t.commands.currency,e=r.match(/^\$(.+?)(\-.+?){0,1}$/),e?n.operand=e[1]||DefaultCurrency||"$":n.operand=r.substring(1)||DefaultCurrency||"$"):"?$"==r?(n.operator=t.commands.currency,n.operand="[?$]"):AllowedColors[r.toUpperCase()]?(n.operator=t.commands.color,n.operand=AllowedColors[r.toUpperCase()]):(e=r.match(/^style=([^']*)$/))?(n.operator=t.commands.style,n.operand=e[1]):","==r?(n.operator=t.commands.separator,n.operand=r):AllowedDates[r.toUpperCase()]?(n.operator=t.commands.date,n.operand=AllowedDates[r.toUpperCase()]):(e=r.match(/^[<>=]/))?(e=r.match(/^([<>=]+)(.+)$/),n.operator=t.commands.comparison,n.operand=e[1]+":"+e[2]):(n.operator=t.commands.copy,n.operand="["+r+"]"),n},exports.abs=abs,exports.acos=acos,exports.add=add,exports.and=and,exports.average=average,exports.bin2dec=bin2dec,exports.branch=branch,exports.cellindex=cellindex,exports.changed=changed,exports.choose=choose,exports.clean=clean,exports.code=code,exports.column=column,exports.columnletter=columnletter,exports.columnnumber=columnnumber,exports.concatenate=concatenate,exports.cos=cos,exports.date=date,exports.datevalue=datevalue,exports.datedif=datedif,exports.days360=days360,exports.dec2bin=dec2bin,exports.diff=diff,exports.divide=divide,exports.eq=eq,exports.exact=exact,exports.filter=filter,exports.find=find,exports.flatten=flatten,exports.gt=gt,exports.gte=gte,exports.guid=guid,exports.hlookup=hlookup,exports.ifblank=ifblank,exports.ifempty=ifempty,exports.iferror=iferror,exports.ifna=ifna,exports.index2col=index2col,exports.index2row=index2row,exports.indirect=indirect,exports.isarray=isarray,exports.isblank=isblank,exports.isdate=isdate,exports.isemail=isemail,exports.isempty=isempty,exports.iserror=iserror,exports.iseven=iseven,exports.isfunction=isfunction,exports.isna=isna,exports.isnumber=isnumber,exports.isodd=isodd,exports.isref=isref,exports.istext=istext,exports.isurl=isurl,exports.len=len,exports.lookup=lookup,exports.lower=lower,exports.lt=lt,exports.lte=lte,exports.min=min,exports.max=max,exports.multiply=multiply,exports.n=n,exports.numbervalue=numbervalue,exports.ne=ne,exports.not=not,exports.oct2dec=oct2dec,exports.or=or,exports.parsebool=parsebool,exports.parsedate=parsedate,exports.pi=pi,exports.pmt=pmt,exports.power=power,exports.ref=ref$1,exports.replace=replace,exports.rept=rept,exports.right=right,exports.round=round,exports.roundup=roundup,exports.search=search,exports.select=select,exports.serial=serial,exports.sin=sin,exports.some=some,exports.sort=sort,exports.split=split,exports.substitute=substitute,exports.subtract=subtract,exports.sum=sum,exports.tan=tan,exports.tau=tau,exports.text=text,exports.trim=trim,exports.unique=unique,exports.upper=upper,exports.vlookup=vlookup,exports.xor=xor;

},{}]},{},[1]);
